
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>The md_harmonize API Reference &#8212; md_harmonize 1.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="The md_harmonize Tutorial" href="tutorial.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-md_harmonize">
<span id="the-md-harmonize-api-reference"></span><h1>The md_harmonize API Reference<a class="headerlink" href="#module-md_harmonize" title="Permalink to this headline">¶</a></h1>
<p>This package includes the following modules.</p>
<span class="target" id="module-md_harmonize.compound"></span><div class="section" id="md-harmonize-compound">
<h2>md_harmonize.compound<a class="headerlink" href="#md-harmonize-compound" title="Permalink to this headline">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#md_harmonize.compound.Atom" title="md_harmonize.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> class, the <a class="reference internal" href="#md_harmonize.compound.Bond" title="md_harmonize.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> class,
and the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> class to construct a compound entity. Most of the instance
variables of these three classes are based on CTFile fields.</p>
<dl class="class">
<dt id="md_harmonize.compound.Atom">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.compound.</code><code class="sig-name descname">Atom</code><span class="sig-paren">(</span><em class="sig-param">atom_symbol: str</em>, <em class="sig-param">atom_number: int</em>, <em class="sig-param">x: str = '0'</em>, <em class="sig-param">y: str = '0'</em>, <em class="sig-param">z: str = '0'</em>, <em class="sig-param">mass_difference: str = '0'</em>, <em class="sig-param">charge: str = '0'</em>, <em class="sig-param">atom_stereo_parity: str = '0'</em>, <em class="sig-param">hydrogen_count: str = '0'</em>, <em class="sig-param">stereo_care_box: str = '0'</em>, <em class="sig-param">valence: str = '0'</em>, <em class="sig-param">h0designator: str = '0'</em>, <em class="sig-param">atom_atom_mapping_number: str = '0'</em>, <em class="sig-param">inversion_retention_flag: str = '0'</em>, <em class="sig-param">exact_change_flag: str = '0'</em>, <em class="sig-param">kat: str = ''</em>, <em class="sig-param">in_cycle: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom class describes the <a class="reference internal" href="#md_harmonize.compound.Atom" title="md_harmonize.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> entity in the compound.</p>
<p>Atom initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_symbol</strong> – atom_symbol.</p></li>
<li><p><strong>atom_number</strong> – atom_number.</p></li>
<li><p><strong>x</strong> – the atom x coordinate.</p></li>
<li><p><strong>y</strong> – the atom y coordinate.</p></li>
<li><p><strong>z</strong> – the atom z coordinate.</p></li>
<li><p><strong>mass_difference</strong> – difference from mass in periodic table.</p></li>
<li><p><strong>charge</strong> – charge.</p></li>
<li><p><strong>atom_stereo_parity</strong> – atom stereo parity.</p></li>
<li><p><strong>hydrogen_count</strong> – hydrogen_count.</p></li>
<li><p><strong>stereo_care_box</strong> – stereo_care_box.</p></li>
<li><p><strong>valence</strong> – valence.</p></li>
<li><p><strong>h0designator</strong> – h0designator (obsolete CTFile parameter).</p></li>
<li><p><strong>atom_atom_mapping_number</strong> – atom_atom_mapping_number.</p></li>
<li><p><strong>inversion_retention_flag</strong> – inversion_retention_flag.</p></li>
<li><p><strong>exact_change_flag</strong> – exact_change_flag.</p></li>
<li><p><strong>kat</strong> – KEGG atom type.</p></li>
<li><p><strong>in_cycle</strong> – whether the atom is in cycle.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.compound.Atom.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">atom_symbol: str</em>, <em class="sig-param">atom_number: int</em>, <em class="sig-param">x: str = '0'</em>, <em class="sig-param">y: str = '0'</em>, <em class="sig-param">z: str = '0'</em>, <em class="sig-param">mass_difference: str = '0'</em>, <em class="sig-param">charge: str = '0'</em>, <em class="sig-param">atom_stereo_parity: str = '0'</em>, <em class="sig-param">hydrogen_count: str = '0'</em>, <em class="sig-param">stereo_care_box: str = '0'</em>, <em class="sig-param">valence: str = '0'</em>, <em class="sig-param">h0designator: str = '0'</em>, <em class="sig-param">atom_atom_mapping_number: str = '0'</em>, <em class="sig-param">inversion_retention_flag: str = '0'</em>, <em class="sig-param">exact_change_flag: str = '0'</em>, <em class="sig-param">kat: str = ''</em>, <em class="sig-param">in_cycle: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_symbol</strong> – atom_symbol.</p></li>
<li><p><strong>atom_number</strong> – atom_number.</p></li>
<li><p><strong>x</strong> – the atom x coordinate.</p></li>
<li><p><strong>y</strong> – the atom y coordinate.</p></li>
<li><p><strong>z</strong> – the atom z coordinate.</p></li>
<li><p><strong>mass_difference</strong> – difference from mass in periodic table.</p></li>
<li><p><strong>charge</strong> – charge.</p></li>
<li><p><strong>atom_stereo_parity</strong> – atom stereo parity.</p></li>
<li><p><strong>hydrogen_count</strong> – hydrogen_count.</p></li>
<li><p><strong>stereo_care_box</strong> – stereo_care_box.</p></li>
<li><p><strong>valence</strong> – valence.</p></li>
<li><p><strong>h0designator</strong> – h0designator (obsolete CTFile parameter).</p></li>
<li><p><strong>atom_atom_mapping_number</strong> – atom_atom_mapping_number.</p></li>
<li><p><strong>inversion_retention_flag</strong> – inversion_retention_flag.</p></li>
<li><p><strong>exact_change_flag</strong> – exact_change_flag.</p></li>
<li><p><strong>kat</strong> – KEGG atom type.</p></li>
<li><p><strong>in_cycle</strong> – whether the atom is in cycle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.update_symbol">
<code class="sig-name descname">update_symbol</code><span class="sig-paren">(</span><em class="sig-param">symbol: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.update_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.update_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symbol</strong> – the updated atom symbol.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom_symbol.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.update_atom_number">
<code class="sig-name descname">update_atom_number</code><span class="sig-paren">(</span><em class="sig-param">index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.update_atom_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.update_atom_number" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.remove_neighbors">
<code class="sig-name descname">remove_neighbors</code><span class="sig-paren">(</span><em class="sig-param">neighbors: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.remove_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.remove_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To remove neighbors from the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of neighbors that will be removed from this atom.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated list of neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.add_neighbors">
<code class="sig-name descname">add_neighbors</code><span class="sig-paren">(</span><em class="sig-param">neighbors: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.add_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.add_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To add neighbors to the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of neighbors that will be added to this atom.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated list of neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.update_stereochemistry">
<code class="sig-name descname">update_stereochemistry</code><span class="sig-paren">(</span><em class="sig-param">stereo: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.update_stereochemistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom stereochemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stereo</strong> – the updated atom stereochemistry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.color_atom">
<code class="sig-name descname">color_atom</code><span class="sig-paren">(</span><em class="sig-param">isotope_resolved: bool = False</em>, <em class="sig-param">charge: bool = False</em>, <em class="sig-param">atom_stereo: bool = False</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.color_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.color_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom color of the zero layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isotope_resolved</strong> – If true, add isotope information when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge information when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereochemistry information when constructing colors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom color of the zero layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.reset_color">
<code class="sig-name descname">reset_color</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.reset_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.reset_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.update_kat">
<code class="sig-name descname">update_kat</code><span class="sig-paren">(</span><em class="sig-param">kat: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.update_kat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.update_kat" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom KEGG atom type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kat</strong> – the KEGG atom type for this atom,</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated KEGG atom type.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.update_cycle">
<code class="sig-name descname">update_cycle</code><span class="sig-paren">(</span><em class="sig-param">cycle_status: bool</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.update_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.update_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the cycle status of the atom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycle_status</strong> – whether the atom is in cycle</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cycle status</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Atom.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Atom.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Atom.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned atom.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.compound.Bond">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.compound.</code><code class="sig-name descname">Bond</code><span class="sig-paren">(</span><em class="sig-param">first_atom_number: str</em>, <em class="sig-param">second_atom_number: str</em>, <em class="sig-param">bond_type: str</em>, <em class="sig-param">bond_stereo: str = '0'</em>, <em class="sig-param">bond_topology: str = '0'</em>, <em class="sig-param">reacting_center_status: str = '0'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Bond"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond class describes the <a class="reference internal" href="#md_harmonize.compound.Bond" title="md_harmonize.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> entity in the compound.</p>
<p>Bond initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_atom_number</strong> – the index of the first atom forming this bond.</p></li>
<li><p><strong>second_atom_number</strong> – the index of the second atom forming this bond.</p></li>
<li><p><strong>bond_type</strong> – the bond type. (1 = Single, 2 = Double, 3 = Triple, 4 = Aromatic, 5 = Single or Double, 6 = Single or Aromatic, 7 = double or Aromatic 8 = Any)</p></li>
<li><p><strong>bond_stereo</strong> – the bond stereo. (Single bonds: 0 = not stereo, 1 = Up, 4 = Either, 6 = Down; Double bonds: determined by x, y, z coordinates)</p></li>
<li><p><strong>bond_topology</strong> – bond topology. (O = Either, 1 = Ring, 2 = Chain)</p></li>
<li><p><strong>reacting_center_status</strong> – reacting center status.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.compound.Bond.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">first_atom_number: str</em>, <em class="sig-param">second_atom_number: str</em>, <em class="sig-param">bond_type: str</em>, <em class="sig-param">bond_stereo: str = '0'</em>, <em class="sig-param">bond_topology: str = '0'</em>, <em class="sig-param">reacting_center_status: str = '0'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_atom_number</strong> – the index of the first atom forming this bond.</p></li>
<li><p><strong>second_atom_number</strong> – the index of the second atom forming this bond.</p></li>
<li><p><strong>bond_type</strong> – the bond type. (1 = Single, 2 = Double, 3 = Triple, 4 = Aromatic, 5 = Single or Double, 6 = Single or Aromatic, 7 = double or Aromatic 8 = Any)</p></li>
<li><p><strong>bond_stereo</strong> – the bond stereo. (Single bonds: 0 = not stereo, 1 = Up, 4 = Either, 6 = Down; Double bonds: determined by x, y, z coordinates)</p></li>
<li><p><strong>bond_topology</strong> – bond topology. (O = Either, 1 = Ring, 2 = Chain)</p></li>
<li><p><strong>reacting_center_status</strong> – reacting center status.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Bond.update_bond_type">
<code class="sig-name descname">update_bond_type</code><span class="sig-paren">(</span><em class="sig-param">bond_type: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.update_bond_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.update_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the bond type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bond_type</strong> – the updated bond type.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated bond type.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Bond.update_stereochemistry">
<code class="sig-name descname">update_stereochemistry</code><span class="sig-paren">(</span><em class="sig-param">stereo: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.update_stereochemistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the bond stereochemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stereo</strong> – the updated bond stereochemistry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated bond stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Bond.update_first_atom">
<code class="sig-name descname">update_first_atom</code><span class="sig-paren">(</span><em class="sig-param">index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.update_first_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.update_first_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the first atom number of the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated first atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated first atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Bond.update_second_atom">
<code class="sig-name descname">update_second_atom</code><span class="sig-paren">(</span><em class="sig-param">index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.update_second_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.update_second_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the second atom number of the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated second atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated second atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Bond.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Bond.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Bond.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned bond.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.compound.Compound">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.compound.</code><code class="sig-name descname">Compound</code><span class="sig-paren">(</span><em class="sig-param">compound_name: str</em>, <em class="sig-param">atoms: list</em>, <em class="sig-param">bonds: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Compound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compound class describes the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
<p>Compound initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_name</strong> – the compound name.</p></li>
<li><p><strong>atoms</strong> – a list of <a class="reference internal" href="#md_harmonize.compound.Atom" title="md_harmonize.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> entities in the compound.</p></li>
<li><p><strong>bonds</strong> – a list of <a class="reference internal" href="#md_harmonize.compound.Bond" title="md_harmonize.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> entities in the compound.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.compound.Compound.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">compound_name: str</em>, <em class="sig-param">atoms: list</em>, <em class="sig-param">bonds: list</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Compound initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_name</strong> – the compound name.</p></li>
<li><p><strong>atoms</strong> – a list of <a class="reference internal" href="#md_harmonize.compound.Atom" title="md_harmonize.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> entities in the compound.</p></li>
<li><p><strong>bonds</strong> – a list of <a class="reference internal" href="#md_harmonize.compound.Bond" title="md_harmonize.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> entities in the compound.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#md_harmonize.compound.Compound.name" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the compound name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the compound name.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.molfile_name">
<em class="property">static </em><code class="sig-name descname">molfile_name</code><span class="sig-paren">(</span><em class="sig-param">molfile: str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.molfile_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.molfile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the compound entity based on the molfile representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the filename of the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed compound entity.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.formula">
<em class="property">property </em><code class="sig-name descname">formula</code><a class="headerlink" href="#md_harmonize.compound.Compound.formula" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the formula of this compound (only consider heavy atoms).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string formula of the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.composition">
<em class="property">property </em><code class="sig-name descname">composition</code><a class="headerlink" href="#md_harmonize.compound.Compound.composition" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the atom symbols and bond types in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the atom and bond information of the compound</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.r_groups">
<em class="property">property </em><code class="sig-name descname">r_groups</code><a class="headerlink" href="#md_harmonize.compound.Compound.r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To get all the R groups in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of index of all the R groups.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.contains_r_groups">
<code class="sig-name descname">contains_r_groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.contains_r_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.contains_r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the compound contains R group(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool whether the compound contains R group.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.has_isolated_atoms">
<code class="sig-name descname">has_isolated_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.has_isolated_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.has_isolated_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the compound has atoms that have no connections to other atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool whether the compound has isolated atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.metal_index">
<em class="property">property </em><code class="sig-name descname">metal_index</code><a class="headerlink" href="#md_harmonize.compound.Compound.metal_index" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the metal elements in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers of metal elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.h_index">
<em class="property">property </em><code class="sig-name descname">h_index</code><a class="headerlink" href="#md_harmonize.compound.Compound.h_index" title="Permalink to this definition">¶</a></dt>
<dd><p>To get all H in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers corresponding to H.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.heavy_atoms">
<em class="property">property </em><code class="sig-name descname">heavy_atoms</code><a class="headerlink" href="#md_harmonize.compound.Compound.heavy_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To get all the heavy atoms in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers corresponding to heavy atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.index_of_heavy_atoms">
<em class="property">property </em><code class="sig-name descname">index_of_heavy_atoms</code><a class="headerlink" href="#md_harmonize.compound.Compound.index_of_heavy_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To map the atom number to index in the heavy atom list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of atom number to atom index of heavy atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.color_groups">
<code class="sig-name descname">color_groups</code><span class="sig-paren">(</span><em class="sig-param">excluded=None</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.color_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.color_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the compound color groups after coloring.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of atom color with the list of atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.detect_abnormal_atom">
<code class="sig-name descname">detect_abnormal_atom</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.detect_abnormal_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.detect_abnormal_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the atoms with invalid bond counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers with invalid bond counts.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.curate_invalid_n">
<code class="sig-name descname">curate_invalid_n</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.curate_invalid_n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.curate_invalid_n" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate the charge of invalid N atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.update_aromatic_bond_type">
<code class="sig-name descname">update_aromatic_bond_type</code><span class="sig-paren">(</span><em class="sig-param">cycles: list</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.update_aromatic_bond_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.update_aromatic_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the aromatic bond types.
Two cases: 1) change the bond in the aromatic ring to aromatic bond (bond type = 4); 2) change the double bond connecting to the aromatic ring to single bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycles</strong> – the list of cycles represented by aromatic atom index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.extract_double_bond_connecting_cycle">
<code class="sig-name descname">extract_double_bond_connecting_cycle</code><span class="sig-paren">(</span><em class="sig-param">atom_in_cycle: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.extract_double_bond_connecting_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.extract_double_bond_connecting_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To extract the double bonds connecting to the atom in the aromatic cycles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_in_cycle</strong> – the list of aromatic cycles represented by aromatic atom index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of outside double bond connecting to the atom in the aromatic cycles.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.extract_aromatic_bonds">
<code class="sig-name descname">extract_aromatic_bonds</code><span class="sig-paren">(</span><em class="sig-param">cycle: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.extract_aromatic_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.extract_aromatic_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the aromatic bonds based on the atoms in the cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycle</strong> – the list of aromatic cycles represented by aromatic atom index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of aromatic bonds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.separate_connected_components">
<code class="sig-name descname">separate_connected_components</code><span class="sig-paren">(</span><em class="sig-param">bonds: Union[list, set]</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.separate_connected_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.separate_connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used in constructing the aromatic substructures detected by the Indigo method.
A compound can have several disjoint aromatic substructures. Here, we need to find the disjoint parts.
The basic idea is union-find. We union atoms that are connected by a bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bonds</strong> – the list of bonds representing by the atom numbers forming the bond.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of separate components represented by a list atom numbers in the component.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.connected_components">
<code class="sig-name descname">connected_components</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.connected_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the connected components in the compound structure (using the breadth first search).
Cases when not all the atoms are connected together.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of the connected components.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.calculate_distance_to_r_groups">
<code class="sig-name descname">calculate_distance_to_r_groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.calculate_distance_to_r_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.calculate_distance_to_r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To calculate the distance of each atom to its nearest R group (using the dijkstra’s algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None:</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_cycles">
<code class="sig-name descname">find_cycles</code><span class="sig-paren">(</span><em class="sig-param">short_circuit: bool = False</em>, <em class="sig-param">cutoff: int = 40</em>, <em class="sig-param">seconds=50</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the cycles in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>short_circuit</strong> – whether to take short path.</p></li>
<li><p><strong>cutoff</strong> – limit of cycle length.</p></li>
<li><p><strong>seconds</strong> – the timeout limit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of cycles in the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_cycles_helper">
<code class="sig-name descname">find_cycles_helper</code><span class="sig-paren">(</span><em class="sig-param">short_circuit: bool = False</em>, <em class="sig-param">cutoff: int = 40</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_cycles_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_cycles_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Executing function to find the cycles in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>short_circuit</strong> – whether to take short path.</p></li>
<li><p><strong>cutoff</strong> – limit of cycle length.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of cycles in the compound</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.structure_matrix">
<code class="sig-name descname">structure_matrix</code><span class="sig-paren">(</span><em class="sig-param">resonance: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.structure_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.structure_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct graph structural matrix of this compound.
matrix[i][j] = 0 suggests the two atoms are not connected directly.
Other integer represented the bond type connecting the two atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resonance</strong> – bool whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>backbone</strong> – bool whether to ignore bond types. This is for parsing atoms mappings from KEGG RCLASS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed structure matrix for this compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.distance_matrix">
<em class="property">property </em><code class="sig-name descname">distance_matrix</code><a class="headerlink" href="#md_harmonize.compound.Compound.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the distance matrix of the compound (using the Floyd Warshall Algorithm).
distance[i][j] suggests the distance between atom i and j.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the distance matrix of the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.update_color_tuple">
<code class="sig-name descname">update_color_tuple</code><span class="sig-paren">(</span><em class="sig-param">resonance: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.update_color_tuple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.update_color_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the color tuple of the atoms in the compound. This color tuple includes information of its neighboring
atoms and bonds. Here, we don’t need to consider backbone since this part was initially designed for aromatic
substructure detection and only double and single bonds are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resonance</strong> – bool whether to ignore the difference between single and double bonds.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_mappings">
<code class="sig-name descname">find_mappings</code><span class="sig-paren">(</span><em class="sig-param">the_other</em>, <em class="sig-param">resonance: bool = True</em>, <em class="sig-param">r_distance: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the one to one atom mappings between two compounds using the BASS algorithm. The other compound  is supposed be
contained in the self compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>resonance</strong> – whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>r_distance</strong> – whether to take account of the position of R groups.</p></li>
<li><p><strong>backbone</strong> – whether to ignore the bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom mappings in the heavy atom order.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_mappings_reversed">
<code class="sig-name descname">find_mappings_reversed</code><span class="sig-paren">(</span><em class="sig-param">the_other</em>, <em class="sig-param">resonance: bool = True</em>, <em class="sig-param">r_distance: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_mappings_reversed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_mappings_reversed" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the one to one atom mappings between two compounds using the BASS algorithm. The self compound is supposed to
be contained in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>resonance</strong> – whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>r_distance</strong> – whether to take account of the position of R groups.</p></li>
<li><p><strong>backbone</strong> – whether to ignore the bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom mappings in the heavy atom order.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.map_resonance">
<code class="sig-name descname">map_resonance</code><span class="sig-paren">(</span><em class="sig-param">the_other</em>, <em class="sig-param">r_distance: bool = False</em>, <em class="sig-param">seconds: int = 50</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.map_resonance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.map_resonance" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the resonant mappings are valid between two compound structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>r_distance</strong> – to take account of the position of R groups.</p></li>
<li><p><strong>seconds</strong> – the timeout limit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of valid atom mappings between the two compound structures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.map_resonance_helper">
<code class="sig-name descname">map_resonance_helper</code><span class="sig-paren">(</span><em class="sig-param">the_other</em>, <em class="sig-param">r_distance: bool = False</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.map_resonance_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.map_resonance_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the resonant mappings are valid between the two compound structures. If the mapped atoms don’t share
the same local coloring identifier, we check if the difference is caused by the position of double bonds.
Find the three atoms involved in the resonant structure and check if one of the atoms is not C.
N (a)            N (a)
/             //         (b) C   N (c)    (b) C   N (c)</p>
<p>In addition, the self compound is supposed to be more generic, which means has fewer atoms. Therefore, atoms in
self compound can all be mapped to the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>r_distance</strong> – to take account of position of R groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of valid atom mappings between the two compound structures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_double_bond_linked_atom">
<code class="sig-name descname">find_double_bond_linked_atom</code><span class="sig-paren">(</span><em class="sig-param">i: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_double_bond_linked_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_double_bond_linked_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the atom that is doubly linked to the target atom i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – the ith atom in the compound.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the index of the doubly linked atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.define_bond_stereochemistry">
<code class="sig-name descname">define_bond_stereochemistry</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.define_bond_stereochemistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.define_bond_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the stereochemistry of double bonds in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.calculate_bond_stereochemistry">
<code class="sig-name descname">calculate_bond_stereochemistry</code><span class="sig-paren">(</span><em class="sig-param">bond: md_harmonize.compound.Bond</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.calculate_bond_stereochemistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.calculate_bond_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the stereochemistry of the double bond based on its geometric properties. The line of the double bond divides
the plane into two parts. For the atoms forming the double bond, it normally has two branches. If the two
branches are not the same, we call them heavy side and light side (heavy side containing atoms with heavier
atomic weights). We determine the bond stereochemistry by checking if the two heavy sides lie on the same part
of the divided plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bond</strong> – the bond entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated bond stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.calculate_y_coordinate">
<em class="property">static </em><code class="sig-name descname">calculate_y_coordinate</code><span class="sig-paren">(</span><em class="sig-param">slope: float</em>, <em class="sig-param">b: float</em>, <em class="sig-param">atom: md_harmonize.compound.Atom</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.calculate_y_coordinate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.calculate_y_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the y coordinate of the atom based on the linear function: y = slope * x + b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> – the slope of the targeted line.</p></li>
<li><p><strong>b</strong> – the intercept of the targeted line.</p></li>
<li><p><strong>atom</strong> – the atom entity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated y coordinate.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.collect_atomic_weights_of_neighbors">
<code class="sig-name descname">collect_atomic_weights_of_neighbors</code><span class="sig-paren">(</span><em class="sig-param">neighbors: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.collect_atomic_weights_of_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.collect_atomic_weights_of_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To collect the atomic weights of the current layer’s neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of atom numbers of neighbors.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atomic weights for this layer’s neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.compare_branch_weights">
<code class="sig-name descname">compare_branch_weights</code><span class="sig-paren">(</span><em class="sig-param">neighbors: list</em>, <em class="sig-param">atom_forming_double_bond: md_harmonize.compound.Atom</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.compare_branch_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.compare_branch_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the heavy and light branches that connect to the atom forming the double bond. This is based on
comparison of the atomic weights of the two branches (breadth first algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbors</strong> – the list of atom numbers of the atoms that connect the atom forming the double bond.</p></li>
<li><p><strong>atom_forming_double_bond</strong> – the atom that forms the bond.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>heavy and light branches. [heavy_side, light_side]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.get_next_layer_neighbors">
<code class="sig-name descname">get_next_layer_neighbors</code><span class="sig-paren">(</span><em class="sig-param">cur_layer_neighbors: list</em>, <em class="sig-param">visited: set</em>, <em class="sig-param">excluded: list = None</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.get_next_layer_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.get_next_layer_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the next layer’s neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cur_layer_neighbors</strong> – the list of atom numbers of the current layer.</p></li>
<li><p><strong>visited</strong> – the atom numbers that have already been visited.</p></li>
<li><p><strong>excluded</strong> – the list of atom numbers that should not be included in the next layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the neighboring atom numbers of the next layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.color_compound">
<code class="sig-name descname">color_compound</code><span class="sig-paren">(</span><em class="sig-param">r_groups: bool = True</em>, <em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">atom_stereo: bool = False</em>, <em class="sig-param">resonance: bool = False</em>, <em class="sig-param">isotope_resolved: bool = False</em>, <em class="sig-param">charge: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.color_compound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.color_compound" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_groups</strong> – If true, add R groups in the coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add bond stereo detail when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereo detail when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double and single bonds.</p></li>
<li><p><strong>isotope_resolved</strong> – If true, add isotope detail when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge detail when constructing colors.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.reset_color">
<code class="sig-name descname">reset_color</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.reset_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.reset_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To set the color of atoms in the compound to be empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None:</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.generate_atom_zero_layer_color">
<code class="sig-name descname">generate_atom_zero_layer_color</code><span class="sig-paren">(</span><em class="sig-param">isotope_resolved: bool = False</em>, <em class="sig-param">charge: bool = False</em>, <em class="sig-param">atom_stereo: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.generate_atom_zero_layer_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.generate_atom_zero_layer_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the color identifier of zero layer for each atom. We don’t consider H and metals here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isotope_resolved</strong> – If true, add isotope detail when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge detail when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereochemistry detail when constructing colors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.generate_atom_color_with_neighbors">
<code class="sig-name descname">generate_atom_color_with_neighbors</code><span class="sig-paren">(</span><em class="sig-param">atom_index: list</em>, <em class="sig-param">excluded: list = None</em>, <em class="sig-param">zero_core_color: bool = True</em>, <em class="sig-param">zero_neighbor_color: bool = True</em>, <em class="sig-param">resonance: bool = False</em>, <em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.generate_atom_color_with_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.generate_atom_color_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom color with its neighbors. We add this color name when we try to incorporate neighbors’
information in naming.</p>
<p>Here, we don’t need to care about the atom stereo. It has been taken care of in generating color_0.</p>
<p>Basic color formula: atom.color + [neighbor.color + bond.bond_type]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> – indices of atoms to color.</p></li>
<li><p><strong>excluded</strong> – the list of atom indices will be excluded from coloring.</p></li>
<li><p><strong>zero_core_color</strong> – If true, we use the atom.color_0 else atom.color for the core atom (first round coloring vs validation).</p></li>
<li><p><strong>zero_neighbor_color</strong> – If true, we use the atom.color_0 else atom.color for the neighbor atoms (first round coloring vs validation).</p></li>
<li><p><strong>resonance</strong> – If true, detect resonant compound pairs without distinguishing between double and single bonds.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo detail of bonds when constructing colors.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of atom index and its color name.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.first_round_color">
<code class="sig-name descname">first_round_color</code><span class="sig-paren">(</span><em class="sig-param">atoms_to_color: list</em>, <em class="sig-param">excluded_index: list = None</em>, <em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">resonance: bool = False</em>, <em class="sig-param">backbone: bool = False</em>, <em class="sig-param">depth: int = 5000</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.first_round_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.first_round_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To do the first round of coloring this compound. We add neighbors’ information layer by layer to the atom’s
color identifier until it has a unique identifier or all the atoms in the compound have been used for naming
(based on the breadth first search algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add bond stereo detail when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
<li><p><strong>depth</strong> – the max depth of coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.invalid_symmetric_atoms">
<code class="sig-name descname">invalid_symmetric_atoms</code><span class="sig-paren">(</span><em class="sig-param">atoms_to_color: list</em>, <em class="sig-param">excluded_index: bool = None</em>, <em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">resonance: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.invalid_symmetric_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.invalid_symmetric_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if atoms with the same color identifier are symmetric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add bond stereo detail when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom numbers to be recolored.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.curate_invalid_symmetric_atoms">
<code class="sig-name descname">curate_invalid_symmetric_atoms</code><span class="sig-paren">(</span><em class="sig-param">atoms_to_color: list</em>, <em class="sig-param">excluded_index: list = None</em>, <em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">resonance: bool = False</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.curate_invalid_symmetric_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.curate_invalid_symmetric_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate the color identifiers of invalid symmetric atoms.
We recolor those invalid atoms using the full color identifiers of its neighbors layer by layer until the
difference can be captured.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers of atoms to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers of atoms to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double bonds and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.color_metal">
<code class="sig-name descname">color_metal</code><span class="sig-paren">(</span><em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">resonance: bool = True</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.color_metal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.color_metal" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the metals in the compound. Here we just incorporate information of directly connected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_stereo</strong> – If true, add bond stereo detail when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore difference between double and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore the bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.color_h">
<code class="sig-name descname">color_h</code><span class="sig-paren">(</span><em class="sig-param">bond_stereo: bool = False</em>, <em class="sig-param">resonance: bool = True</em>, <em class="sig-param">backbone: bool = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.color_h"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.color_h" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the H in the compound. Here we just incorporate information of directly connected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_stereo</strong> – If true, add bond stereo detail when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore difference between double and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.metal_color_identifier">
<code class="sig-name descname">metal_color_identifier</code><span class="sig-paren">(</span><em class="sig-param">details: bool = True</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.metal_color_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.metal_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the metal coloring string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>details</strong> – if true,  to use full metal color when constructing identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the metal coloring string representation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.h_color_identifier">
<code class="sig-name descname">h_color_identifier</code><span class="sig-paren">(</span><em class="sig-param">details: bool = True</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.h_color_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.h_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the H coloring string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>details</strong> – if true, use the full H color when constructing identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the H coloring string representation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.backbone_color_identifier">
<code class="sig-name descname">backbone_color_identifier</code><span class="sig-paren">(</span><em class="sig-param">r_groups: bool = False</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.backbone_color_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.backbone_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the backbone coloring string representation for this compound. Exclude Hs and metals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>r_groups</strong> – whether to include the R group.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the coloring string representation for this compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.get_chemical_details">
<code class="sig-name descname">get_chemical_details</code><span class="sig-paren">(</span><em class="sig-param">excluded: list = None</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.get_chemical_details"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.get_chemical_details" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the chemical details of the compound, which include the atom stereo chemistry and bond stereo chemistry.
This is to compare the compound with the same structures (or the same color identifiers).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>excluded</strong> – a list of atom indices to be ignored.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of chemical details in the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.compare_chemical_details">
<em class="property">static </em><code class="sig-name descname">compare_chemical_details</code><span class="sig-paren">(</span><em class="sig-param">one_chemical_details: list</em>, <em class="sig-param">the_other_chemical_details: list</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.compare_chemical_details"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.compare_chemical_details" title="Permalink to this definition">¶</a></dt>
<dd><p>To compare the chemical details of the two compounds.</p>
<p>Then return the relationship between the two compounds.</p>
<p>The relationship can be equivalent, generic-specific and loose, represented by 0, (-1, 1), 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_chemical_details</strong> – the chemical details of one compound.</p></li>
<li><p><strong>the_other_chemical_details</strong> – the chemical details of the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship between the two structures and the count of chemical details that cannot be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.same_structure_relationship">
<code class="sig-name descname">same_structure_relationship</code><span class="sig-paren">(</span><em class="sig-param">the_other_compound</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.same_structure_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.same_structure_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of two compounds with the same structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.generate_atom_mapping_by_atom_color">
<code class="sig-name descname">generate_atom_mapping_by_atom_color</code><span class="sig-paren">(</span><em class="sig-param">the_other_compound</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.generate_atom_mapping_by_atom_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.generate_atom_mapping_by_atom_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom mappings between the two compounds.</p>
<p>Assume the two compounds have the same structure, so we can achieve atom mappings through atom colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.optimal_resonant_mapping">
<code class="sig-name descname">optimal_resonant_mapping</code><span class="sig-paren">(</span><em class="sig-param">the_other_compound</em>, <em class="sig-param">mappings: list</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.optimal_resonant_mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.optimal_resonant_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the optimal atom mappings for compound pairs that are resonant type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mappings</strong> – the list of atom mappings between the two compounds detected by BASS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.determine_relationship">
<em class="property">static </em><code class="sig-name descname">determine_relationship</code><span class="sig-paren">(</span><em class="sig-param">unmapped_count: dict</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.determine_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.determine_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship between two compounds when there are multiple possible atom mappings.</p>
<p>We try to map as many details as possible.</p>
<p>0: equivalent; 1: self is more generic than the other compound; -1: the other compound is more generic than self;
2: either has chemical detail(s) that the other compound does not have.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unmapped_count</strong> – the dictionary of relationship to the count of details that cannot be mapped.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.circular_pair_relationship">
<code class="sig-name descname">circular_pair_relationship</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em>, <em class="sig-param">seconds: int = 50</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.circular_pair_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.circular_pair_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of two compounds with interchangeable circular and linear representations with time limit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>seconds</strong> – the timeout limit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.circular_pair_relationship_helper">
<code class="sig-name descname">circular_pair_relationship_helper</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.circular_pair_relationship_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.circular_pair_relationship_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of two compounds with interchangeable circular and linear representations.
We first find the critical atoms that involve in the formation of the ring. There can be several possibilities.
Then we break the ring, and restore the double bond in the aldehyde group that forms the ring.
Finally, check if the updated structure is the same with the other compound. And determine the relationship
between the two compounds as well as generate the atom mappings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.break_cycle">
<code class="sig-name descname">break_cycle</code><span class="sig-paren">(</span><em class="sig-param">critical_atoms: int</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.break_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.break_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To break the cycle caused by aldol reaction, which often occurs in the sugar.
Two steps are involved: 1) remove the neighbors. 2) restore the double bond in the aldehyde group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>critical_atoms</strong> – the three critical atoms that are involved in the ring formation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.restore_cycle">
<code class="sig-name descname">restore_cycle</code><span class="sig-paren">(</span><em class="sig-param">critical_atoms: list</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.restore_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.restore_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To restore the ring caused by aldol reaction.
The reverse process of break_cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>critical_atoms</strong> – the three atoms are involved in the aldol reaction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.find_critical_atom_in_cycle">
<code class="sig-name descname">find_critical_atom_in_cycle</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.find_critical_atom_in_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.find_critical_atom_in_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the C (atom_c) and O (atom_oo) in aldehyde group, as well as O (atom_o) in the hydroxy that are involved
in the ring formation. We need to break the bond between the atom_c and atom_o to form the linear transformation.
Please check one example of aldol reaction in the sugar if the description is not confusing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of critical atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.update_atom_symbol">
<code class="sig-name descname">update_atom_symbol</code><span class="sig-paren">(</span><em class="sig-param">index: list</em>, <em class="sig-param">updated_symbol: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.update_atom_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.update_atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom symbols. This is often used to remove/restore R group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – the atom symbols of these indices to be updated.</p></li>
<li><p><strong>updated_symbol</strong> – the updated symbol.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.validate_mapping_with_r">
<code class="sig-name descname">validate_mapping_with_r</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em>, <em class="sig-param">one_rs: list</em>, <em class="sig-param">mapping: dict</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.validate_mapping_with_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.validate_mapping_with_r" title="Permalink to this definition">¶</a></dt>
<dd><p>To validate the atom mappings with r groups.
Here are two things we need to pay attention to:</p>
<ol class="arabic simple">
<li><p>For the generic compound, the R group can be mapped to a branch or just H in the specific compound.</p></li>
<li><p>For the specific compound, every unmatched branch needs to correspond to an R group in the generic compound.</p></li>
</ol>
<p>In other words, the generic compound can have extra R groups that have no matched branch, but the specific
compound cannot have unmatched branches that don’t correspond to any R groups.</p>
<p>For the specific validation:</p>
<p>1) We find all the linkages of R group and mapped atom in the compound, represented by the corresponding atom
number in the other compound and the bond type. (We used the corresponding atom number in the other compound for
the next comparison of the R linkages in the two compounds.</p>
<p>2) For every mapped atom in the other compound, we need to find if it has neighbors that are not mapped. Then
the atom should be linked to a R group. We represent the linkage by the atom number and the bond type.</p>
<p>3) Based on the above validation criteria, we have to make sure that the R linkages in the other compound is the
subset of the R linkages in this compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>one_rs</strong> – the R groups in the compound.</p></li>
<li><p><strong>mapping</strong> – the atom mappings between the mapped parts of the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the atom mappings are valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.compare_chemical_details_with_mapping">
<code class="sig-name descname">compare_chemical_details_with_mapping</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em>, <em class="sig-param">mapping: dict</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.compare_chemical_details_with_mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.compare_chemical_details_with_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>To compare the chemical details of mapped atoms of the two compounds.
This part targets compound pairs with resonance or r_group type.
Only parts of chemicals need to be checked.
1) atoms are not involved in resonance part or connected to R groups (both cases can be tested by the first
layer atom coloring identifier).
2) bond are formed by the atoms described above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mapping</strong> – the mapped atoms between the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the count of chemical details that cannot be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.optimal_mapping_with_r">
<code class="sig-name descname">optimal_mapping_with_r</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em>, <em class="sig-param">one_rs: list</em>, <em class="sig-param">mappings: list</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.optimal_mapping_with_r"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.optimal_mapping_with_r" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the optimal mappings of compound pairs belonging to r_group type. In this case, multiple valid mappings
can exist. We need to find the optimal one with the minimal unmapped chemical details.
And the unmapped chemical details can exist in both compounds (generic or specific).
The unmapped chemical details will determine the relationship of the compound pair.
The priority: generic-specific, loose.
The relationship cannot be equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>one_rs</strong> – the list of R groups in the compound.</p></li>
<li><p><strong>mappings</strong> – the atom mappings of the mapped parts in the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.with_r_pair_relationship">
<code class="sig-name descname">with_r_pair_relationship</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em>, <em class="sig-param">seconds: int = 50</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.with_r_pair_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.with_r_pair_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the relationship and the atom mappings between the two compounds that have r_groups type with a time limit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>seconds</strong> – the timeout limit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.with_r_pair_relationship_helper">
<code class="sig-name descname">with_r_pair_relationship_helper</code><span class="sig-paren">(</span><em class="sig-param">other_compound</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.with_r_pair_relationship_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.with_r_pair_relationship_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the relationship and the atom mappings between the two compounds that have r_groups type.
Several steps are involved:</p>
<p>1) Ignore the R groups in the two compounds and find if one compound (generic compound) is included in the
other compound (specific compound).</p>
<p>2) If we can find the mappings, then we need to validate the mappings with the validate_mapping_with_r
function.</p>
<p>3）Then we get the optimal atom mappings of the mapped parts.</p>
<p>4) We need to map the unmatched branches in the specific compound to the corresponding R group in the generic
compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.compound.Compound.map_r_correspondents">
<code class="sig-name descname">map_r_correspondents</code><span class="sig-paren">(</span><em class="sig-param">one_rs: list</em>, <em class="sig-param">other_compound</em>, <em class="sig-param">mappings: dict</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/compound.html#Compound.map_r_correspondents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.compound.Compound.map_r_correspondents" title="Permalink to this definition">¶</a></dt>
<dd><p>To map the unmatched branches in the specific compound to the corresponding R group in the generic compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_rs</strong> – the list of R groups in the compound.</p></li>
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mappings</strong> – the atom mappings of the mapped parts in the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the full atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-md_harmonize.reaction"></span><div class="section" id="md-harmonize-reaction">
<h2>md_harmonize.reaction<a class="headerlink" href="#md-harmonize-reaction" title="Permalink to this headline">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> class entity.</p>
<dl class="class">
<dt id="md_harmonize.reaction.Reaction">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.reaction.</code><code class="sig-name descname">Reaction</code><span class="sig-paren">(</span><em class="sig-param">reaction_name: str</em>, <em class="sig-param">one_side: list</em>, <em class="sig-param">other_side: list</em>, <em class="sig-param">ecs: dict</em>, <em class="sig-param">atom_mappings: list</em>, <em class="sig-param">coefficients: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/reaction.html#Reaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.reaction.Reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction class describes the <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity.</p>
<p>Reaction initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_name</strong> – the reaction name.</p></li>
<li><p><strong>one_side</strong> – the list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in one side of the reaction.</p></li>
<li><p><strong>other_side</strong> – the list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in the other side of the reaction.</p></li>
<li><p><strong>ecs</strong> – the dict of Enzyme Commission numbers (EC numbers) of the reaction.</p></li>
<li><p><strong>atom_mappings</strong> – the list of atom mappings between two sides of the reaction.</p></li>
<li><p><strong>coefficients</strong> – the dictionary of compound names and their corresponding coefficients in the reaction.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.reaction.Reaction.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">reaction_name: str</em>, <em class="sig-param">one_side: list</em>, <em class="sig-param">other_side: list</em>, <em class="sig-param">ecs: dict</em>, <em class="sig-param">atom_mappings: list</em>, <em class="sig-param">coefficients: dict</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/reaction.html#Reaction.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.reaction.Reaction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_name</strong> – the reaction name.</p></li>
<li><p><strong>one_side</strong> – the list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in one side of the reaction.</p></li>
<li><p><strong>other_side</strong> – the list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in the other side of the reaction.</p></li>
<li><p><strong>ecs</strong> – the dict of Enzyme Commission numbers (EC numbers) of the reaction.</p></li>
<li><p><strong>atom_mappings</strong> – the list of atom mappings between two sides of the reaction.</p></li>
<li><p><strong>coefficients</strong> – the dictionary of compound names and their corresponding coefficients in the reaction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.reaction.Reaction.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#md_harmonize.reaction.Reaction.name" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the reaction name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reaction name.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-md_harmonize.KEGG_database_scraper"></span><div class="section" id="md-harmonize-kegg-database-scraper">
<h2>md_harmonize.KEGG_database_scraper<a class="headerlink" href="#md-harmonize-kegg-database-scraper" title="Permalink to this headline">¶</a></h2>
<p>This module provides functions to download KEGG data (including compound, reaction, kcf, and rclass) from the KEGG (REST) API.</p>
<p>The URLs can change.</p>
<dl class="function">
<dt id="md_harmonize.KEGG_database_scraper.entry_list">
<code class="sig-prename descclassname">md_harmonize.KEGG_database_scraper.</code><code class="sig-name descname">entry_list</code><span class="sig-paren">(</span><em class="sig-param">target_url: str</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_database_scraper.html#entry_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_database_scraper.entry_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the list of entity name to download.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target_url</strong> – the url to fetch.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of entry names.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_database_scraper.update_entity">
<code class="sig-prename descclassname">md_harmonize.KEGG_database_scraper.</code><code class="sig-name descname">update_entity</code><span class="sig-paren">(</span><em class="sig-param">entries: list</em>, <em class="sig-param">sub_directory: str</em>, <em class="sig-param">directory: str</em>, <em class="sig-param">suffix: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/KEGG_database_scraper.html#update_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_database_scraper.update_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>To download the KEGG entity (compound, reaction, or rclass) and save it into a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entries</strong> – the list of entry names to download.</p></li>
<li><p><strong>sub_directory</strong> – the subdirectory to save the downloaded file.</p></li>
<li><p><strong>directory</strong> – the main directory to save the downloaded file.</p></li>
<li><p><strong>suffix</strong> – the suffix needed for download, like the mol for compound molfile and kcf for compound kcf file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_database_scraper.curate_molfile">
<code class="sig-prename descclassname">md_harmonize.KEGG_database_scraper.</code><code class="sig-name descname">curate_molfile</code><span class="sig-paren">(</span><em class="sig-param">file_path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/KEGG_database_scraper.html#curate_molfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_database_scraper.curate_molfile" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate the molfile representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> – the path to the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_database_scraper.download">
<code class="sig-prename descclassname">md_harmonize.KEGG_database_scraper.</code><code class="sig-name descname">download</code><span class="sig-paren">(</span><em class="sig-param">directory: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/KEGG_database_scraper.html#download"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_database_scraper.download" title="Permalink to this definition">¶</a></dt>
<dd><p>To download all the KEGG required files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directory</strong> – the directory to store the data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-md_harmonize.KEGG_parser"></span><div class="section" id="md-harmonize-kegg-parser">
<h2>md_harmonize.KEGG_parser<a class="headerlink" href="#md-harmonize-kegg-parser" title="Permalink to this headline">¶</a></h2>
<p>This module provides functions to parse KEGG data (including compound, reaction, kcf, and rclass).</p>
<dl class="function">
<dt id="md_harmonize.KEGG_parser.kegg_data_parser">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">kegg_data_parser</code><span class="sig-paren">(</span><em class="sig-param">data: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#kegg_data_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.kegg_data_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse KEGG data (reaction, rclass, compound) file to a dictionary.</p>
<p>eg:</p>
<p>ENTRY       R00259                      Reaction</p>
<p>NAME        acetyl-CoA:L-glutamate N-acetyltransferase</p>
<p>DEFINITION  Acetyl-CoA + L-Glutamate &lt;=&gt; CoA + N-Acetyl-L-glutamate</p>
<p>EQUATION    C00024 + C00025 &lt;=&gt; C00010 + C00624</p>
<p>RCLASS      RC00004  C00010_C00024</p>
<blockquote>
<div><p>RC00064  C00025_C00624</p>
</div></blockquote>
<p>ENZYME      2.3.1.1</p>
<p>PATHWAY     rn00220  Arginine biosynthesis</p>
<blockquote>
<div><p>rn01100  Metabolic pathways</p>
<p>rn01110  Biosynthesis of secondary metabolites</p>
<p>rn01210  2-Oxocarboxylic acid metabolism</p>
<p>rn01230  Biosynthesis of amino acids</p>
</div></blockquote>
<p>MODULE      M00028  Ornithine biosynthesis, glutamate =&gt; ornithine</p>
<blockquote>
<div><p>M00845  Arginine biosynthesis, glutamate =&gt; acetylcitrulline =&gt; arginine</p>
</div></blockquote>
<p>ORTHOLOGY   K00618  amino-acid N-acetyltransferase [EC:2.3.1.1]</p>
<blockquote>
<div><p>K00619  amino-acid N-acetyltransferase [EC:2.3.1.1]</p>
<p>K00620  glutamate N-acetyltransferase / amino-acid N-acetyltransferase [EC:2.3.1.35 2.3.1.1]</p>
<p>K11067  N-acetylglutamate synthase [EC:2.3.1.1]</p>
<p>K14681  argininosuccinate lyase / amino-acid N-acetyltransferase [EC:4.3.2.1 2.3.1.1]</p>
<p>K14682  amino-acid N-acetyltransferase [EC:2.3.1.1]</p>
<p>K22476  N-acetylglutamate synthase [EC:2.3.1.1]</p>
<p>K22477  N-acetylglutamate synthase [EC:2.3.1.1]</p>
<p>K22478  bifunctional N-acetylglutamate synthase/kinase [EC:2.3.1.1 2.7.2.8]</p>
</div></blockquote>
<p>DBLINKS     RHEA: 24295</p>
<p>///</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – the KEGG reaction description.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of parsed KEGG data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.parse_equation">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">parse_equation</code><span class="sig-paren">(</span><em class="sig-param">equation: str</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#parse_equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.parse_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse the KEGG reaction equation.</p>
<p>eg:
C00029 + C00001 + 2 C00003 &lt;=&gt; C00167 + 2 C00004 + 2 C00080</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>equation</strong> – the equation string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the parsed KEGG reaction equation.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.kegg_kcf_parser">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">kegg_kcf_parser</code><span class="sig-paren">(</span><em class="sig-param">kcf: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#kegg_kcf_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.kegg_kcf_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse KEGG kcf file to a dictionary.</p>
<p>eg:</p>
<p>ENTRY       C00013                      Compound</p>
<p>ATOM        9</p>
<blockquote>
<div><p>1   P1b P    22.2269  -20.0662</p>
<p>2   O2c O    23.5190  -20.0779</p>
<p>3   O1c O    21.0165  -20.0779</p>
<p>4   O1c O    22.2851  -21.4754</p>
<p>5   O1c O    22.2617  -18.4642</p>
<p>6   P1b P    24.8933  -20.0837</p>
<p>7   O1c O    24.9401  -21.4811</p>
<p>8   O1c O    26.1797  -20.0662</p>
<p>9   O1c O    24.9107  -18.4582</p>
</div></blockquote>
<p>BOND        8</p>
<blockquote>
<div><p>1     1   2 1</p>
<p>2     1   3 1</p>
<p>3     1   4 1</p>
<p>4     1   5 2</p>
<p>5     2   6 1</p>
<p>6     6   7 1</p>
<p>7     6   8 1</p>
<p>8     6   9 2</p>
</div></blockquote>
<p>///</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf</strong> – the kcf text.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of parsed kcf file.</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="md_harmonize.KEGG_parser.reaction_center">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">reaction_center</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">kat</em>, <em class="sig-param">label</em>, <em class="sig-param">match</em>, <em class="sig-param">difference</em><span class="sig-paren">)</span><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new instance of reaction_center(i, kat, label, match, difference)</p>
<dl class="method">
<dt id="md_harmonize.KEGG_parser.reaction_center.__getnewargs__">
<code class="sig-name descname">__getnewargs__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.reaction_center.__new__">
<em class="property">static </em><code class="sig-name descname">__new__</code><span class="sig-paren">(</span><em class="sig-param">_cls</em>, <em class="sig-param">i</em>, <em class="sig-param">kat</em>, <em class="sig-param">label</em>, <em class="sig-param">match</em>, <em class="sig-param">difference</em><span class="sig-paren">)</span><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.__new__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new instance of reaction_center(i, kat, label, match, difference)</p>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.reaction_center.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="attribute">
<dt id="md_harmonize.KEGG_parser.reaction_center.difference">
<code class="sig-name descname">difference</code><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="attribute">
<dt id="md_harmonize.KEGG_parser.reaction_center.i">
<code class="sig-name descname">i</code><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="md_harmonize.KEGG_parser.reaction_center.kat">
<code class="sig-name descname">kat</code><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.kat" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="md_harmonize.KEGG_parser.reaction_center.label">
<code class="sig-name descname">label</code><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="md_harmonize.KEGG_parser.reaction_center.match">
<code class="sig-name descname">match</code><a class="headerlink" href="#md_harmonize.KEGG_parser.reaction_center.match" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.KEGG_parser.RpairParser">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">RpairParser</code><span class="sig-paren">(</span><em class="sig-param">rclass_name: str</em>, <em class="sig-param">rclass_definitions: list</em>, <em class="sig-param">one_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">other_compound: md_harmonize.compound.Compound</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to get one-to-one atom mappings between two compounds based on the rclass definition.</p>
<blockquote>
<div><p>Several steps are involved in this process:</p>
<p>1. The rclass definition can have several pieces. Each piece describes a center atom (R) and its connected atoms.
The connected atoms can stay the same (M) or change (D) between the two compound structures.</p>
<ol class="arabic simple" start="2">
<li><p>First we need to find the center atoms based on the rclass descriptions.</p></li>
</ol>
<p>3. For each center atom, there are can multiple candidates. In other words, based on the RDM description, a bunch
of atoms in the compound can meet the descriptions. (One simple case are the symmetric compounds).</p>
<ol class="arabic" start="4">
<li><p>Therefore, we need to generate the all the combinations for the center atoms in a compound.</p>
<blockquote>
<div><p>eg: if there are three atom centers, each center has several candidates:</p>
<blockquote>
<div><p>center 1: [0, 1, 2]; center 2: [5, 6]; center 3: [10, 11]</p>
<p>The combinations for the center atoms:</p>
<p>[0, 5, 10], [0, 5, 11], [0, 6, 10], [0, 6, 11], [1, 5, 10], [1, 5, 11], [1, 6, 10], [1, 6, 11], [2, 5, 10],
[2, 5, 11], [2, 6, 10], [2, 6, 11]</p>
</div></blockquote>
</div></blockquote>
</li>
<li><p>Next, we need to find the one-to-one atom mappings between the two compounds based on the mapped center atoms.</p></li>
</ol>
<p>6. To solve this issue, we first disassemble each compound into different components. This is due to the
difference atoms in the two compounds, i.e. broken bonds.</p>
<p>7. Then we need to find the mappings between each disassembled component, and concatenate the mappings of all
the components.</p>
<p>8. To find the one-to-one atom mappings, we use the BASS algorithm. We assume the mapped component have the same
structure since we have already removed the different parts. However, here we only map the backbone of the
structure (in other words, we simply all the bond type to 1) due to bond change (double bond to single bond or
triple bond to single bond)</p>
<p>9. To ensure the optimal mappings, we count the mapped atoms with changed local environment and choose the
mapping with minimal changes.</p>
</div></blockquote>
<p>RpairParser initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_name</strong> – the rclass name.</p></li>
<li><p><strong>rclass_definitions</strong> – a list of rclass definitions.</p></li>
<li><p><strong>one_compound</strong> – one compound involved in the pair.</p></li>
<li><p><strong>other_compound</strong> – the other compound involved in the pair.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">rclass_name: str</em>, <em class="sig-param">rclass_definitions: list</em>, <em class="sig-param">one_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">other_compound: md_harmonize.compound.Compound</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>RpairParser initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_name</strong> – the rclass name.</p></li>
<li><p><strong>rclass_definitions</strong> – a list of rclass definitions.</p></li>
<li><p><strong>one_compound</strong> – one compound involved in the pair.</p></li>
<li><p><strong>other_compound</strong> – the other compound involved in the pair.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.map_atom_by_colors">
<code class="sig-name descname">map_atom_by_colors</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.map_atom_by_colors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.map_atom_by_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Roughly map the atoms between the two compounds by the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dict of mapped atom index between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.map_whole_compound">
<code class="sig-name descname">map_whole_compound</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.map_whole_compound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.map_whole_compound" title="Permalink to this definition">¶</a></dt>
<dd><p>Map two compounds if the two compounds can be roughly mapped by the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dict of mapped atom in the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.generate_kat_neighbors">
<em class="property">static </em><code class="sig-name descname">generate_kat_neighbors</code><span class="sig-paren">(</span><em class="sig-param">this_compound: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.generate_kat_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.generate_kat_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the atom neighbors represented by KEGG atom type for each atom in the compound.
This is used to find the center atom.
We used KEGG atom type since the descriptions of atoms in the rclass definitions using KEGG atom type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this_compound</strong> – the compound entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom with its neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.find_target_atom">
<em class="property">static </em><code class="sig-name descname">find_target_atom</code><span class="sig-paren">(</span><em class="sig-param">atoms: list</em>, <em class="sig-param">target: tuple</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.find_target_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.find_target_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the target atoms from a list of candidate atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – a list of atoms to search from.</p></li>
<li><p><strong>target</strong> – the target atom to be searched.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom numbers that match the target atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.create_reaction_centers">
<em class="property">static </em><code class="sig-name descname">create_reaction_centers</code><span class="sig-paren">(</span><em class="sig-param">i: int</em>, <em class="sig-param">kat: str</em>, <em class="sig-param">difference: list</em>, <em class="sig-param">the_other_difference: list</em>, <em class="sig-param">match: list</em>, <em class="sig-param">the_other_match: list</em><span class="sig-paren">)</span> &#x2192; collections.namedtuple<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.create_reaction_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.create_reaction_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the center atom based on its connected atoms and its counterpart atom in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – the ith rclass definition.</p></li>
<li><p><strong>kat</strong> – the KEGG atom type of the center atom.</p></li>
<li><p><strong>difference</strong> – the list of KEGG atom type of different connected atoms.</p></li>
<li><p><strong>the_other_difference</strong> – the list of KEGG atom type of different connected atoms in the other compound.</p></li>
<li><p><strong>match</strong> – the list of KEGG atom type of the matched connected atoms.</p></li>
<li><p><strong>the_other_match</strong> – the list of KEGG atom type of the matched connected atoms in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed reaction center.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.find_center_atoms">
<code class="sig-name descname">find_center_atoms</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.find_center_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.find_center_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Example of rclass definition:</p>
<p>C8x-C8y:*-C1c:N5y+S2x-N5y+S2x</p>
<p>The RDM pattern is defined as KEGG atom type changes at the reaction center (R), the difference region (D),
and the matched region (M) for each reactant pair. It characterizes chemical structure transformation patterns
associated with enzymatic reactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of reaction centers and the corresponding candidate atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.get_center_list">
<em class="property">static </em><code class="sig-name descname">get_center_list</code><span class="sig-paren">(</span><em class="sig-param">center_atom_index: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.get_center_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.get_center_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all the combinations of reaction centers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>center_atom_index</strong> – list of atom index list for each reaction centers. eg: three reaction centers: [[0, 1, 2], [5, 6], [10, 11]].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of combined reaction centers. eg: [[0, 5, 10], [0, 5, 11], [0, 6, 10], [0, 6, 11], [1, 5, 10], [1, 5, 11], [1, 6, 10], [1, 6, 11], [2, 5, 10], [2, 5, 11], [2, 6, 10], [2, 6, 11]]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.remove_different_bonds">
<em class="property">static </em><code class="sig-name descname">remove_different_bonds</code><span class="sig-paren">(</span><em class="sig-param">this_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">center_atom_numbers: list</em>, <em class="sig-param">reaction_centers: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.remove_different_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.remove_different_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the bonds connecting to different atoms. For each reaction center, multiple atoms can be the different
atoms. We need to get all the combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>center_atom_numbers</strong> – the list of atom numbers for center atom in the compound.</p></li>
<li><p><strong>reaction_centers</strong> – the list of reaction center descriptions for the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of bonds (represented by the atom numbers in the bond) that needs to be removed based on the RDM descriptions.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.generate_atom_mappings">
<code class="sig-name descname">generate_atom_mappings</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.generate_atom_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.generate_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the one-to-one atom mappings of the compound pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.detect_components">
<em class="property">static </em><code class="sig-name descname">detect_components</code><span class="sig-paren">(</span><em class="sig-param">this_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">removed_bonds: list</em>, <em class="sig-param">center_atom_numbers: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.detect_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.detect_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect all the components in the compound after removing some bonds.
Basic idea is the breadth first search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>removed_bonds</strong> – the list of removed bonds (represented by the atom numbers in the bond) in the compound.</p></li>
<li><p><strong>center_atom_numbers</strong> – the list of atom numbers of the center atoms in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of components of the compound represented by a list of atom numbers.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.pair_components">
<em class="property">static </em><code class="sig-name descname">pair_components</code><span class="sig-paren">(</span><em class="sig-param">left_components: list</em>, <em class="sig-param">right_components: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.pair_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.pair_components" title="Permalink to this definition">¶</a></dt>
<dd><p>The two compounds are divided into separate components due to the difference atoms. We need to pair each component
in one compound to its counterpart component in the other compound.
Here we roughly pair the components based on the number of atoms in the component. Therefore, every component in
one compound can be paired with several components in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_components</strong> – the components in one compound.</p></li>
<li><p><strong>right_components</strong> – the components in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of paired components.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.construct_component">
<em class="property">static </em><code class="sig-name descname">construct_component</code><span class="sig-paren">(</span><em class="sig-param">this_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">atom_numbers: list</em>, <em class="sig-param">removed_bonds: list</em><span class="sig-paren">)</span> &#x2192; md_harmonize.compound.Compound<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.construct_component"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.construct_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity for the component based on the atom index and removed
bonds, facilitating the following atom mappings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>atom_numbers</strong> – the list of atom numbers in the component.</p></li>
<li><p><strong>removed_bonds</strong> – the list of removed bonds (represented by the atom numbers in the bond) in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed component compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.preliminary_atom_mappings_check">
<em class="property">static </em><code class="sig-name descname">preliminary_atom_mappings_check</code><span class="sig-paren">(</span><em class="sig-param">left_component: md_harmonize.compound.Compound</em>, <em class="sig-param">right_component: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.preliminary_atom_mappings_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.preliminary_atom_mappings_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Roughly evaluate if the atoms between the two components can be mapped.
We compare if the every atom color in the left component has its counterpart in the right component.
Here, we only consider the backbone of the structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_component</strong> – the component in one compound.</p></li>
<li><p><strong>right_component</strong> – the component in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the atoms in the two components can be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.map_components">
<code class="sig-name descname">map_components</code><span class="sig-paren">(</span><em class="sig-param">left_removed_bonds: list</em>, <em class="sig-param">right_removed_bonds: list</em>, <em class="sig-param">left_centers: list</em>, <em class="sig-param">right_centers: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.map_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.map_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Find optimal map for every component in the compound pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_removed_bonds</strong> – the list of removed bonds in one compound.</p></li>
<li><p><strong>right_removed_bonds</strong> – the list of removed bonds in the other compound.</p></li>
<li><p><strong>left_centers</strong> – the list of atom numbers of the center atoms in the one compound.</p></li>
<li><p><strong>right_centers</strong> – the list of atom numbers of the center atoms in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings for the compound pair based on the removed bonds and center atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.combine_atom_mappings">
<code class="sig-name descname">combine_atom_mappings</code><span class="sig-paren">(</span><em class="sig-param">atom_mappings: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.combine_atom_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.combine_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the atom mappings of all the components.
We just mentioned in the pair_components function that every component can have several mappings.
Here, we choose the optimal mapping with the least count of changed atom local identifier. And make sure
that each atom can only to mapped once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_mappings</strong> – the list of atom mappings for all the components.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings for the compound pair.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.validate_component_atom_mappings">
<em class="property">static </em><code class="sig-name descname">validate_component_atom_mappings</code><span class="sig-paren">(</span><em class="sig-param">left_centers: list</em>, <em class="sig-param">right_centers: list</em>, <em class="sig-param">component_atom_mappings: dict</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.validate_component_atom_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.validate_component_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if mapped the atoms can correspond to the mapped reaction center atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_centers</strong> – the list of center atom indices in the left compound.</p></li>
<li><p><strong>right_centers</strong> – the list of center atom indices in the right compound.</p></li>
<li><p><strong>component_atom_mappings</strong> – the one to one atom mappings of one component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the mappings are valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.KEGG_parser.RpairParser.count_changed_atom_identifiers">
<code class="sig-name descname">count_changed_atom_identifiers</code><span class="sig-paren">(</span><em class="sig-param">one_to_one_mappings: dict</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#RpairParser.count_changed_atom_identifiers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.RpairParser.count_changed_atom_identifiers" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the mapped atoms with changed local atom identifier. The different atoms (D in RCLASS definitions)
can cause change of local environment, which can change the atom identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>one_to_one_mappings</strong> – the dictionary of atom mappings between the two compounds.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the total number of mapped atoms with different local identifiers.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.create_compound_kcf">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">create_compound_kcf</code><span class="sig-paren">(</span><em class="sig-param">kcf_file: str</em><span class="sig-paren">)</span> &#x2192; Optional[md_harmonize.compound.Compound]<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#create_compound_kcf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.create_compound_kcf" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct compound entity based on the KEGG kcf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf_file</strong> – the path to the kcf file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed compound entity.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.create_reactions">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">create_reactions</code><span class="sig-paren">(</span><em class="sig-param">reaction_directory: str</em>, <em class="sig-param">atom_mappings: dict</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#create_reactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.create_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Create KEGG <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_directory</strong> – the directory that stores all the reaction files.</p></li>
<li><p><strong>atom_mappings</strong> – the compound pair name and its atom mappings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entities.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.compound_pair_mappings">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">compound_pair_mappings</code><span class="sig-paren">(</span><em class="sig-param">pair_component: tuple</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#compound_pair_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.compound_pair_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atom mappings between two compounds based on the rclass definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pair_component</strong> – a tuple containing the rclass_name, rclass_definitions, one_compound and the_other_compound.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the compound pair name and its atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.KEGG_parser.create_atom_mappings">
<code class="sig-prename descclassname">md_harmonize.KEGG_parser.</code><code class="sig-name descname">create_atom_mappings</code><span class="sig-paren">(</span><em class="sig-param">rclass_directory: str</em>, <em class="sig-param">compounds: dict</em>, <em class="sig-param">seconds: int = 1200</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/KEGG_parser.html#create_atom_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.KEGG_parser.create_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the atom mappings between compounds based on RCLASS definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_directory</strong> – the directory that stores the rclass files.</p></li>
<li><p><strong>compounds</strong> – a dictionary of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>seconds</strong> – the timeout limit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings of compound pairs.</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-md_harmonize.MetaCyc_parser"></span><div class="section" id="md-harmonize-metacyc-parser">
<h2>md_harmonize.MetaCyc_parser<a class="headerlink" href="#md-harmonize-metacyc-parser" title="Permalink to this headline">¶</a></h2>
<p>This module provides functions to parse MetaCyc text data.</p>
<p>Note: All MetaCyc reactions atom_mappings are stored in a single text file.</p>
<dl class="function">
<dt id="md_harmonize.MetaCyc_parser.reaction_side_parser">
<code class="sig-prename descclassname">md_harmonize.MetaCyc_parser.</code><code class="sig-name descname">reaction_side_parser</code><span class="sig-paren">(</span><em class="sig-param">reaction_side: str</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/MetaCyc_parser.html#reaction_side_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.MetaCyc_parser.reaction_side_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse FROM_SIDE or TO_SIDE in the reaction.</p>
<p>eg: FROM-SIDE - (CPD-9147 0 8) (OXYGEN-MOLECULE 9 10)</p>
<p>Information includes compound name and the start and end atom index in this compound used for atom mappings.
The order of the atoms are the orders in the compound molfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reaction_side</strong> – the text description of reaction side.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of compounds and the corresponding start and end atom index in the atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.MetaCyc_parser.generate_one_to_one_mappings">
<code class="sig-prename descclassname">md_harmonize.MetaCyc_parser.</code><code class="sig-name descname">generate_one_to_one_mappings</code><span class="sig-paren">(</span><em class="sig-param">from_side: dict</em>, <em class="sig-param">to_side: dict</em>, <em class="sig-param">indices: str</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/MetaCyc_parser.html#generate_one_to_one_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.MetaCyc_parser.generate_one_to_one_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the one to one atom mappings between two the sides of a metabolic reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_side</strong> – the dictionary of compounds with their corresponding start and end atom indices in the from_side.</p></li>
<li><p><strong>to_side</strong> – the dictionary of compounds with their corresponding start and end atom indices in the to_side.</p></li>
<li><p><strong>indices</strong> – the string representation of mapped atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of mapped atoms between the two sides (from_index, to_index).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.MetaCyc_parser.atom_mappings_parser">
<code class="sig-prename descclassname">md_harmonize.MetaCyc_parser.</code><code class="sig-name descname">atom_mappings_parser</code><span class="sig-paren">(</span><em class="sig-param">atom_mapping_text: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/MetaCyc_parser.html#atom_mappings_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.MetaCyc_parser.atom_mappings_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse the MetaCyc reaction with atom mappings.</p>
<p>eg:</p>
<p>REACTION - RXN-11981</p>
<p>NTH-ATOM-MAPPING - 1</p>
<p>MAPPING-TYPE - NO-HYDROGEN-ENCODING</p>
<p>FROM-SIDE - (CPD-12950 0 23) (WATER 24 24)</p>
<p>TO-SIDE - (CPD-12949 0 24)</p>
<p>INDICES - 0 1 2 3 5 4 7 6 9 10 11 13 12 14 15 16 17 8 18 19 21 20 22 24 23</p>
<p>note: the INDICES are atom mappings between two sides of the reaction.
TO-SIDE[i] is mapped to FROM-SIDE[idx] for i, idx in enumerate(INDICES).
Pay attention to the direction!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_mapping_text</strong> – the text descriptions of reactions with atom mappings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of reactions with atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.MetaCyc_parser.reaction_parser">
<code class="sig-prename descclassname">md_harmonize.MetaCyc_parser.</code><code class="sig-name descname">reaction_parser</code><span class="sig-paren">(</span><em class="sig-param">reaction_text: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/MetaCyc_parser.html#reaction_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.MetaCyc_parser.reaction_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to parse MetaCyc reaction.</p>
<p>eg:</p>
<p>UNIQUE-ID - RXN-13583</p>
<p>TYPES - Redox-Half-Reactions</p>
<p>ATOM-MAPPINGS - (:NO-HYDROGEN-ENCODING (1 0 2) (((WATER 0 0) (HYDROXYLAMINE 1 2)) ((NITRITE 0 2))))</p>
<p>CREDITS - SRI</p>
<p>CREDITS - caspi</p>
<p>IN-PATHWAY - HAONITRO-RXN</p>
<p>LEFT - NITRITE</p>
<p>^COMPARTMENT - CCO-IN</p>
<p>LEFT - PROTON</p>
<p>^COEFFICIENT - 5</p>
<p>^COMPARTMENT - CCO-IN</p>
<p>LEFT - E-</p>
<p>^COEFFICIENT - 4</p>
<p>ORPHAN? - :NO</p>
<p>PHYSIOLOGICALLY-RELEVANT? - T</p>
<p>REACTION-BALANCE-STATUS - :BALANCED</p>
<p>REACTION-DIRECTION - LEFT-TO-RIGHT</p>
<p>RIGHT - HYDROXYLAMINE</p>
<p>^COMPARTMENT - CCO-IN</p>
<p>RIGHT - WATER</p>
<p>^COMPARTMENT - CCO-IN</p>
<p>STD-REDUCTION-POTENTIAL - 0.1</p>
<p>//</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reaction_text</strong> – the text descriptions of MetaCyc reactions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dict of parsed MetaCyc reactions.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.MetaCyc_parser.create_reactions">
<code class="sig-prename descclassname">md_harmonize.MetaCyc_parser.</code><code class="sig-name descname">create_reactions</code><span class="sig-paren">(</span><em class="sig-param">reaction_file: str</em>, <em class="sig-param">atom_mapping_file: str</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/MetaCyc_parser.html#create_reactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.MetaCyc_parser.create_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>To molfile_name MetaCyc reaction entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_file</strong> – the path to the reaction file.</p></li>
<li><p><strong>atom_mapping_file</strong> – the path to the atom mapping file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of constructed <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entities.</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-md_harmonize.aromatics"></span><div class="section" id="md-harmonize-aromatics">
<h2>md_harmonize.aromatics<a class="headerlink" href="#md-harmonize-aromatics" title="Permalink to this headline">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#md_harmonize.aromatics.AromaticManager" title="md_harmonize.aromatics.AromaticManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AromaticManager</span></code></a> class entity.</p>
<dl class="class">
<dt id="md_harmonize.aromatics.AromaticManager">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.aromatics.</code><code class="sig-name descname">AromaticManager</code><span class="sig-paren">(</span><em class="sig-param">aromatic_substructures: list = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Two major functions are implemented in AromaticManager.</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Extract aromatic substructures based on labelled aromatic atoms (mainly C and N) or Indigo detected aromatic bonds.</dt><dd><p>The first case only applies to KEGG compounds, and the second case applies to compounds from any databases.</p>
</dd>
</dl>
</li>
<li><p>Detect the aromatic substructures in any given compound, and update the bond type of the detected aromatic bonds.</p></li>
</ol>
<p>AromaticManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>aromatic_substructures</strong> – a list of aromatic substructures.</p>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">aromatic_substructures: list = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>AromaticManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>aromatic_substructures</strong> – a list of aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>To encode the aromatic substructures in the aromatic manager. (Get error when try to jsonpickle the
AromaticManager: the cythonized entities cannot be pickled.)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.decode">
<em class="property">static </em><code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param">aromatic_structures: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the AromaticManager based on the aromatic substructures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>aromatic_structures</strong> – the list of aromatic substructures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed AromaticManager.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.add_aromatic_substructures">
<code class="sig-name descname">add_aromatic_substructures</code><span class="sig-paren">(</span><em class="sig-param">substructures: list</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.add_aromatic_substructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.add_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Add newly detected aromatic structures to the manager. Make sure no duplicates in the aromatic substructures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>substructures</strong> – a list of aromatic substructures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.kegg_aromatize">
<code class="sig-name descname">kegg_aromatize</code><span class="sig-paren">(</span><em class="sig-param">kcf_cpd: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.kegg_aromatize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.kegg_aromatize" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract aromatic substructures based on KEGG atom type in KEGG compound parsed from KCF file, and add the
newly detected aromatic substructures to the AromaticManager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf_cpd</strong> – the KEGG compound entity derived from KCF file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.indigo_aromatize">
<code class="sig-name descname">indigo_aromatize</code><span class="sig-paren">(</span><em class="sig-param">molfile: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.indigo_aromatize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.indigo_aromatize" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract aromatic substructures via Indigo, and add the newly detected aromatic substructures to the
AromaticManager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the path to the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.indigo_aromatic_bonds">
<code class="sig-name descname">indigo_aromatic_bonds</code><span class="sig-paren">(</span><em class="sig-param">molfile: str</em><span class="sig-paren">)</span> &#x2192; set<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.indigo_aromatic_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.indigo_aromatic_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the aromatic bonds in the compound via Indigo method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the path to the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the set of aromatic bonds represented by first_atom_number and second_atom_number in the bond.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.fuse_cycles">
<em class="property">static </em><code class="sig-name descname">fuse_cycles</code><span class="sig-paren">(</span><em class="sig-param">cycles: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.fuse_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.fuse_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>To fuse the cycles with shared atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycles</strong> – the list of cycles represented by atom numbers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of cleaned cycles.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.detect_aromatic_substructures_timeout">
<code class="sig-name descname">detect_aromatic_substructures_timeout</code><span class="sig-paren">(</span><em class="sig-param">cpd: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.detect_aromatic_substructures_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.detect_aromatic_substructures_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the aromatic substructures in the compound and stop the search on timeout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cpd</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.detect_aromatic_substructures">
<code class="sig-name descname">detect_aromatic_substructures</code><span class="sig-paren">(</span><em class="sig-param">cpd: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.detect_aromatic_substructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.detect_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect all the aromatic substructures in the cpd, and update the bond type of aromatic bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cpd</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.construct_aromatic_entity">
<em class="property">static </em><code class="sig-name descname">construct_aromatic_entity</code><span class="sig-paren">(</span><em class="sig-param">cpd: md_harmonize.compound.Compound</em>, <em class="sig-param">aromatic_cycles: list</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.construct_aromatic_entity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.construct_aromatic_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the aromatic substructure entity based on the aromatic atoms.
Here, we also include outside atoms that are connected to aromatic rings with double bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpd</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>aromatic_cycles</strong> – the list of aromatic cycles represented by atom numbers in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of constructed aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.aromatics.AromaticManager.extract_aromatic_substructures">
<code class="sig-name descname">extract_aromatic_substructures</code><span class="sig-paren">(</span><em class="sig-param">cpd: md_harmonize.compound.Compound</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/aromatics.html#AromaticManager.extract_aromatic_substructures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.aromatics.AromaticManager.extract_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the aromatic substructures in a compound based on the aromatic atoms. This only applies to KEGG kcf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cpd</strong> – the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of aromatic cycles represented by atom numbers.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-md_harmonize.harmonization"></span><div class="section" id="md-harmonize-harmonization">
<h2>md_harmonize.harmonization<a class="headerlink" href="#md-harmonize-harmonization" title="Permalink to this headline">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedEdge" title="md_harmonize.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> class,
the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedCompoundEdge" title="md_harmonize.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a> class,
and the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedReactionEdge" title="md_harmonize.harmonization.HarmonizedReactionEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedReactionEdge</span></code></a> class .</p>
<dl class="class">
<dt id="md_harmonize.harmonization.HarmonizedEdge">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">HarmonizedEdge</code><span class="sig-paren">(</span><em class="sig-param">one_side: Union[md_harmonize.compound.Compound, md_harmonize.reaction.Reaction], other_side: Union[md_harmonize.compound.Compound, md_harmonize.reaction.Reaction], relationship: int, edge_type: Union[str, int], mappings: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedEdge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedEdge representing compound or reaction pairs.</p>
<p>HarmonizedEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_side</strong> – one side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>other_side</strong> – the other side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>relationship</strong> – equivalent, generic-specific, or loose.</p></li>
<li><p><strong>edge_type</strong> – for compound edge, this represents resonance, linear-circular, r group, same structure; for reaction edge, this represents 3 level match or 4 level match.</p></li>
<li><p><strong>mappings</strong> – for compound edge, the mappings refer to mapped atoms between compounds; for reaction edge, the mappings refer to mapped compounds between reaction.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedEdge.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">one_side: Union[md_harmonize.compound.Compound, md_harmonize.reaction.Reaction], other_side: Union[md_harmonize.compound.Compound, md_harmonize.reaction.Reaction], relationship: int, edge_type: Union[str, int], mappings: dict</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedEdge.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_side</strong> – one side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>other_side</strong> – the other side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>relationship</strong> – equivalent, generic-specific, or loose.</p></li>
<li><p><strong>edge_type</strong> – for compound edge, this represents resonance, linear-circular, r group, same structure; for reaction edge, this represents 3 level match or 4 level match.</p></li>
<li><p><strong>mappings</strong> – for compound edge, the mappings refer to mapped atoms between compounds; for reaction edge, the mappings refer to mapped compounds between reaction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedEdge.reversed_relationship">
<em class="property">property </em><code class="sig-name descname">reversed_relationship</code><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedEdge.reversed_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the relationship between the other side and one side.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reversed relationship.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedEdge.pair_relationship">
<code class="sig-name descname">pair_relationship</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedEdge.pair_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedEdge.pair_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>When we map compounds in the reaction, we can access the compound edge from either side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – the name of the searched one side.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship of the searched pair.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.harmonization.HarmonizedCompoundEdge">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">HarmonizedCompoundEdge</code><span class="sig-paren">(</span><em class="sig-param">one_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">other_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">relationship: int</em>, <em class="sig-param">edge_type: str</em>, <em class="sig-param">atom_mappings: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedCompoundEdge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedCompoundEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedCompoundEdge representing compound pairs.</p>
<p>HarmonizedCompoundEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compound</strong> – one <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two compounds.</p></li>
<li><p><strong>edge_type</strong> – the edge type can be resonance, linear-circular, r group, or same structure.</p></li>
<li><p><strong>atom_mappings</strong> – the atom mappings between the two compounds.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedCompoundEdge.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">one_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">other_compound: md_harmonize.compound.Compound</em>, <em class="sig-param">relationship: int</em>, <em class="sig-param">edge_type: str</em>, <em class="sig-param">atom_mappings: dict</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedCompoundEdge.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedCompoundEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedCompoundEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compound</strong> – one <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>other_compound</strong> – the other <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two compounds.</p></li>
<li><p><strong>edge_type</strong> – the edge type can be resonance, linear-circular, r group, or same structure.</p></li>
<li><p><strong>atom_mappings</strong> – the atom mappings between the two compounds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedCompoundEdge.reversed_mappings">
<em class="property">property </em><code class="sig-name descname">reversed_mappings</code><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedCompoundEdge.reversed_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atom mappings from compound on the other side to compound on the one side.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>atom mappings between the other side compound to one side compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedCompoundEdge.pair_atom_mappings">
<code class="sig-name descname">pair_atom_mappings</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedCompoundEdge.pair_atom_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedCompoundEdge.pair_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atom mappings of the harmonized compound edge, where one side equals to the parameter name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – the compound name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.harmonization.HarmonizedReactionEdge">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">HarmonizedReactionEdge</code><span class="sig-paren">(</span><em class="sig-param">one_reaction: md_harmonize.reaction.Reaction</em>, <em class="sig-param">other_reaction: md_harmonize.reaction.Reaction</em>, <em class="sig-param">relationship: int</em>, <em class="sig-param">edge_type: int</em>, <em class="sig-param">compound_mappings: dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedReactionEdge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedReactionEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedReactionEdge to represent reaction pairs.</p>
<p>HarmonizedReactionEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_reaction</strong> – one <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>other_reaction</strong> – the other <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two reactions.</p></li>
<li><p><strong>edge_type</strong> – the reactions can be 3-level EC or 4-level EC paired.</p></li>
<li><p><strong>compound_mappings</strong> – the dictionary of paired compounds in the reaction pair.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizedReactionEdge.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">one_reaction: md_harmonize.reaction.Reaction</em>, <em class="sig-param">other_reaction: md_harmonize.reaction.Reaction</em>, <em class="sig-param">relationship: int</em>, <em class="sig-param">edge_type: int</em>, <em class="sig-param">compound_mappings: dict</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizedReactionEdge.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizedReactionEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedReactionEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_reaction</strong> – one <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>other_reaction</strong> – the other <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two reactions.</p></li>
<li><p><strong>edge_type</strong> – the reactions can be 3-level EC or 4-level EC paired.</p></li>
<li><p><strong>compound_mappings</strong> – the dictionary of paired compounds in the reaction pair.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.harmonization.HarmonizationManager">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">HarmonizationManager</code><a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizationManger is responsible for adding, removing or searching harmonized edge.</p>
<p>HarmonizationManager initializer.</p>
<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizationManager initializer.</p>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.save_manager">
<code class="sig-name descname">save_manager</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.save_manager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.save_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Save all the names of harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of harmonized edges.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.create_key">
<em class="property">static </em><code class="sig-name descname">create_key</code><span class="sig-paren">(</span><em class="sig-param">name_1: str</em>, <em class="sig-param">name_2: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.create_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.create_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the edge key. Each edge is represented by a unique key in the harmonized_edges dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the key of the edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param">edge: Union[md_harmonize.harmonization.HarmonizedCompoundEdge, md_harmonize.harmonization.HarmonizedReactionEdge]</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.add_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add this edge to the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedEdge" title="md_harmonize.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge is added successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.remove_edge">
<code class="sig-name descname">remove_edge</code><span class="sig-paren">(</span><em class="sig-param">edge: Union[md_harmonize.harmonization.HarmonizedCompoundEdge, md_harmonize.harmonization.HarmonizedReactionEdge]</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.remove_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.remove_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove this edge from the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedEdge" title="md_harmonize.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge is removed successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.HarmonizationManager.search">
<code class="sig-name descname">search</code><span class="sig-paren">(</span><em class="sig-param">name_1: str</em>, <em class="sig-param">name_2: str</em><span class="sig-paren">)</span> &#x2192; Union[md_harmonize.harmonization.HarmonizedCompoundEdge, md_harmonize.harmonization.HarmonizedReactionEdge, None]<a class="reference internal" href="_modules/md_harmonize/harmonization.html#HarmonizationManager.search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.HarmonizationManager.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search the edge based on the names of the two sides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>edge if the edge exists or None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">CompoundHarmonizationManager</code><a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The CompoundHarmonizationManager is responsible for adding, removing or searching
<a class="reference internal" href="#md_harmonize.harmonization.HarmonizedCompoundEdge" title="md_harmonize.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a>.</p>
<p>CompoundHarmonizationManager initializer.</p>
<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>CompoundHarmonizationManager initializer.</p>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.find_compound">
<em class="property">static </em><code class="sig-name descname">find_compound</code><span class="sig-paren">(</span><em class="sig-param">compound_dict: list</em>, <em class="sig-param">compound_name: str</em><span class="sig-paren">)</span> &#x2192; Optional[md_harmonize.compound.Compound]<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.find_compound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.find_compound" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> based on the compound name in the compound dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_dict</strong> – a list of compound dictionaries.</p></li>
<li><p><strong>compound_name</strong> – the target compound name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.create_manager">
<em class="property">static </em><code class="sig-name descname">create_manager</code><span class="sig-paren">(</span><em class="sig-param">compound_dict: list</em>, <em class="sig-param">compound_pairs: list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.create_manager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.create_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> based on the compound paris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_dict</strong> – the list of compound dictionaries.</p></li>
<li><p><strong>compound_pairs</strong> – the list of compound pairs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param">edge: md_harmonize.harmonization.HarmonizedCompoundEdge</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.add_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a newly detected edge to the manager, and update the occurrences of compound in the harmonized edges.
This is for calculating the jaccard index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedCompoundEdge" title="md_harmonize.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge is added successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.remove_edge">
<code class="sig-name descname">remove_edge</code><span class="sig-paren">(</span><em class="sig-param">edge: md_harmonize.harmonization.HarmonizedCompoundEdge</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.remove_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.remove_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the edge from the manager, and update the occurrences of compound in the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.HarmonizedCompoundEdge" title="md_harmonize.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge is removed successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.has_visited">
<code class="sig-name descname">has_visited</code><span class="sig-paren">(</span><em class="sig-param">name_1: str</em>, <em class="sig-param">name_2: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.has_visited"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.has_visited" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the compound pair has been visited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool if the pair has been visited.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.add_invalid">
<code class="sig-name descname">add_invalid</code><span class="sig-paren">(</span><em class="sig-param">name_1: str</em>, <em class="sig-param">name_2: str</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.add_invalid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.add_invalid" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the name of invalid compound pair to the visited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.CompoundHarmonizationManager.get_edge_list">
<code class="sig-name descname">get_edge_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/md_harmonize/harmonization.html#CompoundHarmonizationManager.get_edge_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.CompoundHarmonizationManager.get_edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the names of all the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of names of harmonized edges.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager">
<em class="property">class </em><code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">ReactionHarmonizationManager</code><span class="sig-paren">(</span><em class="sig-param">compound_harmonization_manager: md_harmonize.harmonization.CompoundHarmonizationManager</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The ReactionHarmonizationManager is responsible for adding, removing or searching
<a class="reference internal" href="#md_harmonize.harmonization.HarmonizedReactionEdge" title="md_harmonize.harmonization.HarmonizedReactionEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedReactionEdge</span></code></a>.</p>
<p>ReactionHarmonizationManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compound_harmonization_manager</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> entity for compound pairs management.</p>
</dd>
</dl>
<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">compound_harmonization_manager: md_harmonize.harmonization.CompoundHarmonizationManager</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>ReactionHarmonizationManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compound_harmonization_manager</strong> – the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> entity for compound pairs management.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.compare_ecs">
<em class="property">static </em><code class="sig-name descname">compare_ecs</code><span class="sig-paren">(</span><em class="sig-param">one_ecs: dict</em>, <em class="sig-param">other_ecs: dict</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.compare_ecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.compare_ecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two lists of EC numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_ecs</strong> – the dict of EC numbers of one reaction.</p></li>
<li><p><strong>other_ecs</strong> – the dict of EC numbers of the other reaction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the level of EC number that they can be matched.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.determine_relationship">
<em class="property">static </em><code class="sig-name descname">determine_relationship</code><span class="sig-paren">(</span><em class="sig-param">relationships: list</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.determine_relationship"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.determine_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the relationship of the reaction pair based on the relationship of paired compounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>relationships</strong> – the list of relationship of compound pairs in the two reactions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationships between the two reactions.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.harmonize_reaction">
<code class="sig-name descname">harmonize_reaction</code><span class="sig-paren">(</span><em class="sig-param">one_reaction: md_harmonize.reaction.Reaction</em>, <em class="sig-param">other_reaction: md_harmonize.reaction.Reaction</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.harmonize_reaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.harmonize_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if two reactions can be harmonized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_reaction</strong> – one <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> that is involved in the reaction pair.</p></li>
<li><p><strong>other_reaction</strong> – the other <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> that is involved in the reaction pair.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.compound_mappings">
<code class="sig-name descname">compound_mappings</code><span class="sig-paren">(</span><em class="sig-param">one_compounds: list</em>, <em class="sig-param">other_compounds: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.compound_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.compound_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mapped compounds in the two compound lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>other_compounds</strong> – the other list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of paired compounds with their relationship. The relationship will be used to determine the relationship of reaction pair.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.unmapped_compounds">
<code class="sig-name descname">unmapped_compounds</code><span class="sig-paren">(</span><em class="sig-param">one_compounds: list</em>, <em class="sig-param">other_compounds: list</em>, <em class="sig-param">mappings: dict</em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.unmapped_compounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.unmapped_compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the compounds that cannot be mapped. This can lead to new compound pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>other_compounds</strong> – the other list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>mappings</strong> – the mapped compounds between the two compound lists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>two lists of compounds that cannot be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.match_unmapped_compounds">
<code class="sig-name descname">match_unmapped_compounds</code><span class="sig-paren">(</span><em class="sig-param">one_side_left: list</em>, <em class="sig-param">other_side_left: list</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.match_unmapped_compounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.match_unmapped_compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Match the left compounds and add the valid compound pairs to the
<a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a>.
We also add the invalid compound pairs to the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> to avoid
redundant match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_side_left</strong> – one list of left <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>other_side_left</strong> – the other list of left <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.jaccard">
<code class="sig-name descname">jaccard</code><span class="sig-paren">(</span><em class="sig-param">one_compounds: list</em>, <em class="sig-param">other_compounds: list</em>, <em class="sig-param">mappings: dict</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.jaccard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.jaccard" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the jaccard index between the two list of compounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>other_compounds</strong> – the other list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>mappings</strong> – the dictionary of mapped compounds between the two compound lists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the jaccard index of the two compound lists.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="md_harmonize.harmonization.ReactionHarmonizationManager.one_to_one_compound_mappings">
<code class="sig-name descname">one_to_one_compound_mappings</code><span class="sig-paren">(</span><em class="sig-param">mappings: dict</em><span class="sig-paren">)</span> &#x2192; Optional[tuple]<a class="reference internal" href="_modules/md_harmonize/harmonization.html#ReactionHarmonizationManager.one_to_one_compound_mappings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.ReactionHarmonizationManager.one_to_one_compound_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the one-to-one compound mappings between the two reactions.
This step is to avoid very extreme cases that a compound in one reaction can be mapped to two or more compounds
in the other reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mappings</strong> – the dictionary of compound mappings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the tuple of relationship of compound pairs and dictionary of one-to-one compound mappings.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="md_harmonize.harmonization.harmonize_compound_list">
<code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">harmonize_compound_list</code><span class="sig-paren">(</span><em class="sig-param">compound_dict_list: list</em><span class="sig-paren">)</span> &#x2192; md_harmonize.harmonization.CompoundHarmonizationManager<a class="reference internal" href="_modules/md_harmonize/harmonization.html#harmonize_compound_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.harmonize_compound_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Harmonize compounds across different databases based on the compound coloring identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compound_dict_list</strong> – the list of <a class="reference internal" href="#md_harmonize.compound.Compound" title="md_harmonize.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> dictionary from different sources.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> containing harmonized compound edges.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="md_harmonize.harmonization.harmonize_reaction_list">
<code class="sig-prename descclassname">md_harmonize.harmonization.</code><code class="sig-name descname">harmonize_reaction_list</code><span class="sig-paren">(</span><em class="sig-param">reaction_lists: list</em>, <em class="sig-param">compound_harmonization_manager: md_harmonize.harmonization.CompoundHarmonizationManager</em><span class="sig-paren">)</span> &#x2192; md_harmonize.harmonization.ReactionHarmonizationManager<a class="reference internal" href="_modules/md_harmonize/harmonization.html#harmonize_reaction_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#md_harmonize.harmonization.harmonize_reaction_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Harmonize reactions across different sources based on the harmonized compounds. At the same time, this also
harmonizes compound pairs with resonance, linear-circular, r group types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_lists</strong> – a list of <a class="reference internal" href="#md_harmonize.reaction.Reaction" title="md_harmonize.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> lists from different sources.</p></li>
<li><p><strong>compound_harmonization_manager</strong> – a <a class="reference internal" href="#md_harmonize.harmonization.CompoundHarmonizationManager" title="md_harmonize.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> containing harmonized compound pairs with the same structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#md_harmonize.harmonization.ReactionHarmonizationManager" title="md_harmonize.harmonization.ReactionHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReactionHarmonizationManager</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">md_harmonize</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">The md_harmonize Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The md_harmonize API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-compound">md_harmonize.compound</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-reaction">md_harmonize.reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-kegg-database-scraper">md_harmonize.KEGG_database_scraper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-kegg-parser">md_harmonize.KEGG_parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-metacyc-parser">md_harmonize.MetaCyc_parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-aromatics">md_harmonize.aromatics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#md-harmonize-harmonization">md_harmonize.harmonization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tutorial.html" title="previous chapter">The md_harmonize Tutorial</a></li>
      <li>Next: <a href="license.html" title="next chapter">License</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Huan Jin & Hunter Moseley.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>