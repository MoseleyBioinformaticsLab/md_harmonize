
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The MDH API Reference &#8212; mdh 1.0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="The MDH Tutorial" href="tutorial.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-mdh">
<span id="the-mdh-api-reference"></span><h1>The MDH API Reference<a class="headerlink" href="#module-mdh" title="Permalink to this heading">¶</a></h1>
<p>Routines for working with MDH.</p>
<p>This package includes the following modules.</p>
<span class="target" id="module-mdh.compound"></span><section id="mdh-compound">
<h2>mdh.compound<a class="headerlink" href="#mdh-compound" title="Permalink to this heading">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#mdh.compound.Atom" title="mdh.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> class, the <a class="reference internal" href="#mdh.compound.Bond" title="mdh.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">mdh.compound.Bond</span></code></a> class,
and the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> class to construct compound entity.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="mdh.compound.Atom">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.compound.</span></span><span class="sig-name descname"><span class="pre">Atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_difference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereo_parity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogen_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereo_care_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0designator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_atom_mapping_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inversion_retention_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact_change_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom class describes the <a class="reference internal" href="#mdh.compound.Atom" title="mdh.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> entity in the compound.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_difference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereo_parity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrogen_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereo_care_box</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h0designator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_atom_mapping_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inversion_retention_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact_change_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Atom.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_symbol</strong> – atom_symbol.</p></li>
<li><p><strong>atom_number</strong> – atom_number.</p></li>
<li><p><strong>x</strong> – the atom x coordinate.</p></li>
<li><p><strong>y</strong> – the atom y coordinate.</p></li>
<li><p><strong>z</strong> – the atom z coordinate.</p></li>
<li><p><strong>mass_difference</strong> – difference from mass in periodic table.</p></li>
<li><p><strong>charge</strong> – charge.</p></li>
<li><p><strong>atom_stereo_parity</strong> – atom stereo parity.</p></li>
<li><p><strong>hydrogen_count</strong> – hydrogen_count.</p></li>
<li><p><strong>stereo_care_box</strong> – stereo_care_box.</p></li>
<li><p><strong>valence</strong> – valence.</p></li>
<li><p><strong>h0designator</strong> – h0designator.</p></li>
<li><p><strong>atom_atom_mapping_number</strong> – atom_atom_mapping_number.</p></li>
<li><p><strong>inversion_retention_flag</strong> – inversion_retention_flag.</p></li>
<li><p><strong>exact_change_flag</strong> – exact_change_flag.</p></li>
<li><p><strong>kat</strong> – KEGG atom type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.update_symbol">
<span class="sig-name descname"><span class="pre">update_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.update_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.update_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>symbol</strong> – the updated atom symbol.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom_symbol.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.update_atom_number">
<span class="sig-name descname"><span class="pre">update_atom_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.update_atom_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.update_atom_number" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.remove_neighbors">
<span class="sig-name descname"><span class="pre">remove_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.remove_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.remove_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To remove neighbors to the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of neighbors that will be removed from this atom.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated list of neighbors of the atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.add_neighbors">
<span class="sig-name descname"><span class="pre">add_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.add_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.add_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To add neighbors to the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of neighbors that will be removed from this atom.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated list of neighbors of the atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.update_stereochemistry">
<span class="sig-name descname"><span class="pre">update_stereochemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.update_stereochemistry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom stereochemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stereo</strong> – the updated atom stereochemistry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated atom stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.color_atom">
<span class="sig-name descname"><span class="pre">color_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isotope_resolved</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.color_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.color_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the zero layer atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isotope_resolved</strong> – If true, add isotope information when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge information when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereochemistry information when constructing colors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the zero layer atom color.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.reset_color">
<span class="sig-name descname"><span class="pre">reset_color</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.reset_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.reset_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.update_kat">
<span class="sig-name descname"><span class="pre">update_kat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Atom.update_kat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.update_kat" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom KEGG atom type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kat</strong> – the KEGG atom type for this atom,</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated KEGG atom type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Atom.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Atom.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Atom.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned atom.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.compound.Bond">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.compound.</span></span><span class="sig-name descname"><span class="pre">Bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_topology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reacting_center_status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond class describes the <a class="reference internal" href="#mdh.compound.Bond" title="mdh.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> entity in the compound.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_atom_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_topology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reacting_center_status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'0'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Bond.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_atom_number</strong> – the index of the first atom forming this bond.</p></li>
<li><p><strong>second_atom_number</strong> – the index of the second atom forming this bond.</p></li>
<li><p><strong>bond_type</strong> – the bond type. (1 = Single, 2 = Double, 3 = Triple, 4 = Aromatic, 5 = Single or</p></li>
</ul>
</dd>
</dl>
<p>Double, 6 = Single or Aromatic, 7 = double or Aromatic 8 = Any)
:param bond_stereo: the bond stereo. (Single bonds: 0 = not stereo, 1 = Up, 4 = Either, 6 = Down;
Double bonds: determined by x, y, z coordinates)
:param bond_topology: bond topology. (O = Either, 1 = Ring, 2 = Chain)
:param reacting_center_status: reacting center status.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.update_bond_type">
<span class="sig-name descname"><span class="pre">update_bond_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Bond.update_bond_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.update_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the bond type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bond_type</strong> – the updated bond type.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated bond type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.update_stereochemistry">
<span class="sig-name descname"><span class="pre">update_stereochemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Bond.update_stereochemistry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.update_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the bond stereochemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stereo</strong> – the updated bond stereochemistry.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated bond stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.update_first_atom">
<span class="sig-name descname"><span class="pre">update_first_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Bond.update_first_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.update_first_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the first atom number of the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated first atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated first atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.update_second_atom">
<span class="sig-name descname"><span class="pre">update_second_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Bond.update_second_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.update_second_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the second atom number of the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> – the updated second atom number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the updated second atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Bond.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Bond.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Bond.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned bond.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.compound.Compound">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.compound.</span></span><span class="sig-name descname"><span class="pre">Compound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Compound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compound class describes the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Compound initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_name</strong> – the compound name.</p></li>
<li><p><strong>atoms</strong> – a list of <a class="reference internal" href="#mdh.compound.Atom" title="mdh.compound.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> entities in the compound.</p></li>
<li><p><strong>bonds</strong> – a list of <a class="reference internal" href="#mdh.compound.Bond" title="mdh.compound.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a> entities in the compound.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>To clone the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the cloned compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#mdh.compound.Compound.name" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the compound name.
:return: the compound name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.create">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Compound.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the compound entity based on the molfile representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the filename of the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed compound entity.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.formula">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">formula</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#mdh.compound.Compound.formula" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the formula of this compound (only consider heavy atoms).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string formula of the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.composition">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">composition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#mdh.compound.Compound.composition" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the atom symbols and bond types in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the atom and bond information of the compound</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.r_groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_groups</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#mdh.compound.Compound.r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To get all the R groups in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of index of all the R groups.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.contains_r_groups">
<span class="sig-name descname"><span class="pre">contains_r_groups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.contains_r_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.contains_r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the compound contains R group(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool whether the compound contains R group.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.has_isolated_atoms">
<span class="sig-name descname"><span class="pre">has_isolated_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.has_isolated_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.has_isolated_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the compound has atoms that have no connections to other atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool whether the compound has isolated atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.metal_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metal_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#mdh.compound.Compound.metal_index" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the metals in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers of metals.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.h_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">h_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#mdh.compound.Compound.h_index" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the H(s) in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers of H(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.heavy_atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">heavy_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#mdh.compound.Compound.heavy_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To get all the heavy atoms in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers of heavy atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.index_of_heavy_atoms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">index_of_heavy_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#mdh.compound.Compound.index_of_heavy_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To map the atom number to index in the heavy atom list.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of atom number to atom index of heavy atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.color_groups">
<span class="sig-name descname"><span class="pre">color_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excluded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.color_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.color_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the compound color groups after coloring.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of atom color with the list of atom number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.detect_abnormal_atom">
<span class="sig-name descname"><span class="pre">detect_abnormal_atom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.detect_abnormal_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.detect_abnormal_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the atoms with invalid bond counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of atom numbers with invalid bond counts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.curate_invalid_n">
<span class="sig-name descname"><span class="pre">curate_invalid_n</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.curate_invalid_n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.curate_invalid_n" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate charge of the invalid N atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.update_aromatic_bond_type">
<span class="sig-name descname"><span class="pre">update_aromatic_bond_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.update_aromatic_bond_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.update_aromatic_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the aromatic bond types.
Two cases: 1) change the bond in the aromatic ring to aromatic bond (bond type = 4)</p>
<blockquote>
<div><ol class="arabic simple" start="2">
<li><p>change the double bond connecting to the aromatic ring to single bond.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycles</strong> – the list of cycles of aromatic atom index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.extract_double_bond_connecting_cycle">
<span class="sig-name descname"><span class="pre">extract_double_bond_connecting_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_in_cycle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.extract_double_bond_connecting_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.extract_double_bond_connecting_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To extract the double bonds connecting to the aromatic cycles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_in_cycle</strong> – the list of atoms in the aromatic cycles.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of outside double bond connecting to the aromatic cycles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.extract_aromatic_bonds">
<span class="sig-name descname"><span class="pre">extract_aromatic_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.extract_aromatic_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.extract_aromatic_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the aromatic bonds based on the atom indexes in the cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycle</strong> – the list of atoms in the aromatic cycles.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of aromatic bond.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.separate_connected_components">
<span class="sig-name descname"><span class="pre">separate_connected_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">set</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.separate_connected_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.separate_connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used in constructing the aromatic substructures detected by Indigo method.
A compound can have several disjoint aromatic substructures. Here, we need to find the disjoint parts.
The basic idea is union-find. We union atoms that are connected by a bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bonds</strong> – the list of bonds representing by the atom numbers in the bond.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of components represented by a list atom numbers in each component.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.connected_components">
<span class="sig-name descname"><span class="pre">connected_components</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.connected_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect the connected components in the compound structure. (using the breadth first search)
Cases when not all the atoms are connected together.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dictionary of the connected components.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.calculate_distance_to_r_groups">
<span class="sig-name descname"><span class="pre">calculate_distance_to_r_groups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.calculate_distance_to_r_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.calculate_distance_to_r_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>To calculate the distance of each atom to its nearest R group (using the dijkstra’s algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None:</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_cycles">
<span class="sig-name descname"><span class="pre">find_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">short_circuit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_cycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the cycles in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of cycles in the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_cycles_helper">
<span class="sig-name descname"><span class="pre">find_cycles_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">short_circuit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_cycles_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_cycles_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Executing function to find the cycles in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of cycles in the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.structure_matrix">
<span class="sig-name descname"><span class="pre">structure_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.structure_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.structure_matrix" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>To construct graph structural matrix of this compound.
matrix[i][j] = 0 suggests the two atoms are not connected directly.
Other integer represented the bond type connecting the two atoms.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>resonance</strong> – bool whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>backbone</strong> – bool whether to ignore bond types. This is for parsing atoms mappings from KEGG RCLASS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed structure matrix for this compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.compound.Compound.distance_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#mdh.compound.Compound.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the distance matrix of the compound. (using the Floyd Warshall Algorithm)
distance[i][j] suggests the distance between atom i and j.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the distance matrix of the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.update_color_tuple">
<span class="sig-name descname"><span class="pre">update_color_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.update_color_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.update_color_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the color tuple of the atoms in the compound. This color tuple includes information of its neighboring
atoms and bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resonance</strong> – bool whether to ignore the difference between single and double bonds.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_mappings">
<span class="sig-name descname"><span class="pre">find_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the one to one atom mappings between two compounds using BASS algorithm. The other compound  is supposed be
contained in the self compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>resonance</strong> – whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>r_distance</strong> – whether to take account of position of R groups.</p></li>
<li><p><strong>backbone</strong> – whether to ignore the bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom mappings in the heavy atom order.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_mappings_reversed">
<span class="sig-name descname"><span class="pre">find_mappings_reversed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_mappings_reversed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_mappings_reversed" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the one to one atom mappings between two compounds using BASS algorithm. The self compound is supposed to
be contained in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>resonance</strong> – whether to ignore the difference between single and double bonds.</p></li>
<li><p><strong>r_distance</strong> – whether to take account of position of R groups.</p></li>
<li><p><strong>backbone</strong> – whether to ignore the bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom mappings in the heavy atom order.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.map_resonance">
<span class="sig-name descname"><span class="pre">map_resonance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.map_resonance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.map_resonance" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the resonant mappings are valid between the two compound structures. If the mapped atoms don’t share
the same local coloring identifier, we check if the difference is caused by the position of double bonds.
Find the three atoms involved in the resonant structure and check if one of the atom is not C.</p>
<blockquote>
<div><p>N (a)            N (a)
/             //             (b) C   N (c)    (b) C   N (c)</p>
</div></blockquote>
<p>In addition, the self compound is supposed to be more generic, which means has smaller atoms. Therefore, atom in
self compound can all be mapped to the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other</strong> – the mappings compound entity.</p></li>
<li><p><strong>r_distance</strong> – to take account of position of R groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of valid atom mappings between the two compound structures.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_double_bond_linked_atom">
<span class="sig-name descname"><span class="pre">find_double_bond_linked_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_double_bond_linked_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_double_bond_linked_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the atom that is doubly linked to the target atom[i].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – the ith atom in the compound.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the index of the doubly linked atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.define_bond_stereochemistry">
<span class="sig-name descname"><span class="pre">define_bond_stereochemistry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.define_bond_stereochemistry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.define_bond_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the stereochemistry of double bonds in the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.calculate_bond_stereochemistry">
<span class="sig-name descname"><span class="pre">calculate_bond_stereochemistry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Bond" title="mdh.compound.Bond"><span class="pre">Bond</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.calculate_bond_stereochemistry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.calculate_bond_stereochemistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the stereochemistry of double bond based on the geometric properties. The line of double bond divides
the plane into two parts. For the atom forming the double bond, it normally has two branches. If the two
branches are not the same, we can them heavy side and light side (heavy side containing atoms with heavier
atomic weights). We determine the bond stereochemistry by checking if the two heavy sides lie on the same part
of the divided plane.</p>
<blockquote>
<div><p>H   L   H   H
___/   ___/</p>
<blockquote>
<div><p>___     ___</p>
</div></blockquote>
<p>/     /               L   H   L   L
trans   cis</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bond</strong> – the bond entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated bond stereochemistry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.calculate_y_coordinate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_y_coordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Atom" title="mdh.compound.Atom"><span class="pre">Atom</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.calculate_y_coordinate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.calculate_y_coordinate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the y coordinate of the atom based on the linear function: y = slope * x + b</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> – the slope of the targeted line.</p></li>
<li><p><strong>b</strong> – the intercept of the targeted line.</p></li>
<li><p><strong>atom</strong> – the atom entity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated y coordinate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.collect_atomic_weights_of_neighbors">
<span class="sig-name descname"><span class="pre">collect_atomic_weights_of_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.collect_atomic_weights_of_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.collect_atomic_weights_of_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To collect the atomic weights of the current layer’s neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>neighbors</strong> – the list of neighboring atom numbers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atomic weight for this layer’s neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.compare_branch_weights">
<span class="sig-name descname"><span class="pre">compare_branch_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_forming_double_bond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Atom" title="mdh.compound.Atom"><span class="pre">Atom</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.compare_branch_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.compare_branch_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the heavy and light branches connecting the atom forming the double bond. This is based on
comparison of the atomic weights of the two branches. (Breadth first algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbors</strong> – the list of atom numbers of the atoms connecting the atom forming the double bond.</p></li>
<li><p><strong>atom_forming_double_bond</strong> – the atom that forms the bond.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>heavy and light branches. [heavy_side, light_side]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.get_next_layer_neighbors">
<span class="sig-name descname"><span class="pre">get_next_layer_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur_layer_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visited</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.get_next_layer_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.get_next_layer_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the next layer’s neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cur_layer_neighbors</strong> – the list of atom numbers of the current layer.</p></li>
<li><p><strong>visited</strong> – the atom numbers that have already visited.</p></li>
<li><p><strong>excluded</strong> – the list of atom numbers that should not be included in the next layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom numbers of next layer’s neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.color_compound">
<span class="sig-name descname"><span class="pre">color_compound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotope_resolved</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.color_compound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.color_compound" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_groups</strong> – If true, add R groups in the coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereo information when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore difference between double bonds and single bonds.</p></li>
<li><p><strong>isotope_resolved</strong> – If true, add isotope information when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge information when constructing colors.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.reset_color">
<span class="sig-name descname"><span class="pre">reset_color</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.reset_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.reset_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To set the color of atoms and compound to empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None:</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.generate_atom_zero_layer_color">
<span class="sig-name descname"><span class="pre">generate_atom_zero_layer_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isotope_resolved</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.generate_atom_zero_layer_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.generate_atom_zero_layer_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the zero layer color identifier for each atom. We don’t consider H and metals here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isotope_resolved</strong> – If true, add isotope information when constructing colors.</p></li>
<li><p><strong>charge</strong> – If true, add charge information when constructing colors.</p></li>
<li><p><strong>atom_stereo</strong> – If true, add atom stereochemistry information when constructing colors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.generate_atom_color_with_neighbors">
<span class="sig-name descname"><span class="pre">generate_atom_color_with_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_core_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_neighbor_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.generate_atom_color_with_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.generate_atom_color_with_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom color with its neighbors. We add this color name when we try to incorporate neighbors’
information in naming.
Here, we don’t need to care about the atom stereo. It has been taken care of in generating color_0.
Basic color formula: atom.color + [neighbor.color + bond.bond_type]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> – the list of atom index to color.</p></li>
<li><p><strong>excluded</strong> – the list of atom index will be excluded from coloring.</p></li>
<li><p><strong>zero_core_color</strong> – If ture, we use the atom.color_0 else atom.color for the core atom.</p></li>
<li><p><strong>zero_neighbor_color</strong> – If ture, we use the atom.color_0 else atom.color for the neighbor atoms.</p></li>
<li><p><strong>resonance</strong> – If true, detect resonant compound pairs without distinguish between double bonds and single bonds.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of atom index to its color name containing neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.first_round_color">
<span class="sig-name descname"><span class="pre">first_round_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_to_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.first_round_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.first_round_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To do the first round of coloring this compound. We add neighbors’ information layer by layer to the atom color
identifier until it has a unique identifier or all the atoms in the compound have been used for naming.
(based on the breadth first search algorithm)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers of atoms to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers of atoms to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double bonds and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
<li><p><strong>depth</strong> – the max depth of coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.invalid_symmetric_atoms">
<span class="sig-name descname"><span class="pre">invalid_symmetric_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_to_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.invalid_symmetric_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.invalid_symmetric_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the atoms with the same color identifier are symmetric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers of atoms to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers of atoms to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double bonds and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atoms to be recolored.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.curate_invalid_symmetric_atoms">
<span class="sig-name descname"><span class="pre">curate_invalid_symmetric_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_to_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.curate_invalid_symmetric_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.curate_invalid_symmetric_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate the atom color identifier of invalid symmetric atom.
We recolor those invalid atoms with the full color identifiers of its neighbors layer by layer until where the
difference can be captured.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms_to_color</strong> – the list of atom numbers of atoms to be colored.</p></li>
<li><p><strong>excluded_index</strong> – the list of atom numbers of atoms to be excluded from coloring.</p></li>
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore the difference between double bonds and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types in the coloring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.color_metal">
<span class="sig-name descname"><span class="pre">color_metal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.color_metal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.color_metal" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the metals in the compound. Here we just incorporate information of directly connected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, ignore difference between double bonds and single bonds.</p></li>
<li><p><strong>backbone</strong> – If true, ignore bond types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.color_h">
<span class="sig-name descname"><span class="pre">color_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resonance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.color_h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.color_h" title="Permalink to this definition">¶</a></dt>
<dd><p>To color the metals in the compound. Here we just incorporate information of directly connected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_stereo</strong> – If true, add stereo information to bonds when constructing colors.</p></li>
<li><p><strong>resonance</strong> – If true, detect resonant compound pairs without distinguish between double bonds and single</p></li>
</ul>
</dd>
</dl>
<p>bonds.
:param backbone: If true, ignore bond types.
:return: None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.metal_color_identifier">
<span class="sig-name descname"><span class="pre">metal_color_identifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">details</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.metal_color_identifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.metal_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the metal color string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>details</strong> – if true, use full metal color when constructing identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the metal color string representation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.h_color_identifier">
<span class="sig-name descname"><span class="pre">h_color_identifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">details</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.h_color_identifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.h_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the H color string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>details</strong> – if true, use the full H color when constructing identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the H color string representation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.backbone_color_identifier">
<span class="sig-name descname"><span class="pre">backbone_color_identifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.backbone_color_identifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.backbone_color_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the backbone color identifier for this compound. Exclude Hs and metals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>r_groups</strong> – bool whether to include the R group.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the color string identifier for this compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.get_chemical_details">
<span class="sig-name descname"><span class="pre">get_chemical_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">excluded</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.get_chemical_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.get_chemical_details" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the chemical details of the compound, which include the atom stereo chemistry and bond stereo chemistry.
This is to compare compound with the same structures (or the same color identifiers).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>excluded</strong> – the atoms to be ignored.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of chemical details in the compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.compare_chemical_details">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compare_chemical_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_chemical_details</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_chemical_details</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.compare_chemical_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.compare_chemical_details" title="Permalink to this definition">¶</a></dt>
<dd><p>To compare the chemical details of the two compounds.
Then return the relationship between the two compounds.
The relationship can be equivalent, generic-specific and loose, represented by 0, (-1, 1), 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_chemical_details</strong> – the chemical details of one compound.</p></li>
<li><p><strong>the_other_chemical_details</strong> – the chemical details of the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship between the two structures and the count of not mapped chemical details.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.same_structure_relationship">
<span class="sig-name descname"><span class="pre">same_structure_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'int'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'dict'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Compound.same_structure_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.same_structure_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of two compounds with the same structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.generate_atom_mapping_by_atom_color">
<span class="sig-name descname"><span class="pre">generate_atom_mapping_by_atom_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.generate_atom_mapping_by_atom_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.generate_atom_mapping_by_atom_color" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom mappings between the two compounds.
Assume the two compounds have the same structure, so we can achieve atom mappings through atom colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.optimal_resonant_mapping">
<span class="sig-name descname"><span class="pre">optimal_resonant_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings:</span> <span class="pre">list)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'int'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'dict'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/compound.html#Compound.optimal_resonant_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.optimal_resonant_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the optimal atom mappings for compound pairs that are resonant type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mappings</strong> – the list of atom mappings between the two compounds detected by BASS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.determine_relationship">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">determine_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unmapped_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.determine_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.determine_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship between two compounds when there are multiple possible atom mappings.
We try to map as many details as possible. In other words, try to minimize the unmapped details.</p>
<p>0: equivalent; 1: self is more generic than the other compound; -1: the other compound is more generic than self;
2: either has chemical detail(s) that the other compound does not have.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unmapped_count</strong> – the dictionary of relationship to the count of unmapped details.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.circular_pair_relationship_helper">
<span class="sig-name descname"><span class="pre">circular_pair_relationship_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.circular_pair_relationship_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.circular_pair_relationship_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of two compounds with interchangeable circular and linear representations.
We first find the critical atoms that involve in the formation of ring. There can be several possibilities.
Then we break the ring, and restore the double bond in the aldehyde group that forms the ring.
Finally, check if the updated structure is the same with the other compound. And determine the relationship
between the two compounds as well as generate the atom mappings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.break_cycle">
<span class="sig-name descname"><span class="pre">break_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">critical_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.break_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.break_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To break the cycle caused by aldol reaction, which often occurs in the sugar.
Two steps are involved: 1) remove the neighbors. 2) restore the double bond in the aldehyde group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>critical_atoms</strong> – the three critical atoms that are involved in the ring formation.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.restore_cycle">
<span class="sig-name descname"><span class="pre">restore_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">critical_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.restore_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.restore_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To restore the ring caused by aldol reaction.
The reverse process of the above break_cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>critical_atoms</strong> – the three atoms are involved in the aldol reaction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.find_critical_atom_in_cycle">
<span class="sig-name descname"><span class="pre">find_critical_atom_in_cycle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.find_critical_atom_in_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.find_critical_atom_in_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the C (atom_c) and O (atom_oo) in aldehyde group, as well as O (atom_o) in the hydroxy that are involved
in the ring formation. We need to break the bond between the atom_c and atom_o to form the linear transformation.
Please check one example of aldol reaction in the sugar if the description is not confusing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of critical atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.update_atom_symbol">
<span class="sig-name descname"><span class="pre">update_atom_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">updated_symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.update_atom_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.update_atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>To update the atom symbols. This is often used to remove/restore R group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – the atom symbols of these indexes to be updated.</p></li>
<li><p><strong>updated_symbol</strong> – the updated symbol.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.validate_mapping_with_r">
<span class="sig-name descname"><span class="pre">validate_mapping_with_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.validate_mapping_with_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.validate_mapping_with_r" title="Permalink to this definition">¶</a></dt>
<dd><p>To validate the atom mappings with r groups.
Here are two things we need to pay attention to:
1) For the generic compound, its R group can be mapped to a branch or just H in the specific compound.
2) For the specific compound, every unmatched branch needs to correspond to a R group in the generic compound.
In other words, the generic compound can have extra R groups that have no matched branch, but the specific
compound cannot have unmatched branches that don’t have corresponding R group.</p>
<p>For the specific validation:
1) We find all the linkages of R group and mapped atom in the compound, represented by the corresponding atom
number in the other compound and the bond type. (We used the corresponding atom number in the other compound for
the next comparison of the R linkages in the two compounds.
2) For every mapped atom in the other compound, we need to find if it has neighbors that are not mapped. Then
the atom should be linked to a R group. We represent the linkage by the atom number and the bond type.
3) Based on the above validation criteria, we have to make sure that the R linkages in the other compound is the
subset of the R linkages in this compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>one_rs</strong> – the R groups in the compound.</p></li>
<li><p><strong>mapping</strong> – the atom mappings between the mapped parts of the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the atom mappings are valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.compare_chemical_details_with_mapping">
<span class="sig-name descname"><span class="pre">compare_chemical_details_with_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.compare_chemical_details_with_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.compare_chemical_details_with_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>To compare the chemical details of mapped atoms of the two compounds.
This part targets compound pairs with resonance or r_group type.
Only parts of chemicals need to be checked.
1) atoms are not involved in resonance part or connected to R groups (both cases can be tested by the first
layer atom coloring identifier.
2) bond are formed by the atoms describe above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mapping</strong> – the mapped atoms between the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the count of not mapped chemical details in both compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.optimal_mapping_with_r">
<span class="sig-name descname"><span class="pre">optimal_mapping_with_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.optimal_mapping_with_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.optimal_mapping_with_r" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the optimal mappings of compound pairs belonging to r_group type. In this case, multiple valid mappings
can exist. We need to find the optimal one. The standard is the mappings with minimal unmapped chemical details.
And the unmapped chemical details can exist in both compounds (generic or specific).
The unmapped chemical details will determine the relationship of the compound pair.
The priority: generic-specific, loose.
Here the relationship cannot be equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>one_rs</strong> – the list of R groups in the compound.</p></li>
<li><p><strong>mappings</strong> – the atom mappings of the mapped parts of the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.with_r_pair_relationship_helper">
<span class="sig-name descname"><span class="pre">with_r_pair_relationship_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.with_r_pair_relationship_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.with_r_pair_relationship_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the relationship and the atom mappings between the two compounds that has r_groups type.
Several steps are involved:
1) Ignore the R groups in the two compounds and find if one compound (generic compound) is included in the
other compound (specific compound).
2) If we can find the mappings, then we need to validate the mappings. Please the validate_mapping_with_r
function.
3) Then we get the optimal atom mappings of the mapped parts.
4) We need to map the unmatched branches in the specific compound to the corresponding R group in the generic
compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship and the atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.compound.Compound.map_r_correspondents">
<span class="sig-name descname"><span class="pre">map_r_correspondents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/compound.html#Compound.map_r_correspondents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.compound.Compound.map_r_correspondents" title="Permalink to this definition">¶</a></dt>
<dd><p>To map the unmatched branches in the specific compound to the corresponding R group in the generic compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_rs</strong> – the list of R groups in the compound.</p></li>
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>mappings</strong> – the atom mappings of the mapped parts of the two compounds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the full atom mappings between the two compounds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-mdh.reaction"></span><section id="mdh-reaction">
<h2>MDH.reaction<a class="headerlink" href="#mdh-reaction" title="Permalink to this heading">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> class entity.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="mdh.reaction.Reaction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.reaction.</span></span><span class="sig-name descname"><span class="pre">Reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/reaction.html#Reaction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.reaction.Reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction class describes the <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.reaction.Reaction.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/reaction.html#Reaction.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.reaction.Reaction.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_name</strong> – the reaction name.</p></li>
<li><p><strong>one_side</strong> – the list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in one side of the reaction.</p></li>
<li><p><strong>the_other_side</strong> – the list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities in the other side of the reaction.</p></li>
<li><p><strong>ecs</strong> – the dict of Enzyme Commission numbers (EC numbers) of the reaction.</p></li>
<li><p><strong>atom_mappings</strong> – the list of atom mappings between two sides of the reaction.</p></li>
<li><p><strong>coefficients</strong> – the dictionary of compound names and their corresponding coefficients in the reaction.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.reaction.Reaction.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#mdh.reaction.Reaction.name" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the reaction name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reaction name.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-mdh.KEGG_database_scraper"></span><p>KEGG_database_scraper.py is used to download KEGG data (including compound, reaction, kcf, and rclass) from web.</p>
<p>This URL can change.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_database_scraper.entry_list">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_database_scraper.</span></span><span class="sig-name descname"><span class="pre">entry_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_database_scraper.html#entry_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_database_scraper.entry_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the list of entity name to download.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>target_url</strong> – the url to fetch.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of entry names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_database_scraper.update_entity">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_database_scraper.</span></span><span class="sig-name descname"><span class="pre">update_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_database_scraper.html#update_entity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_database_scraper.update_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>To download the KEGG entity (compound, reaction, or rclass) and save it into a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>entries</strong> – the list of entry name to download.</p></li>
<li><p><strong>sub_directory</strong> – the subdirectory to save the downloaded file.</p></li>
<li><p><strong>directory</strong> – the main directory to save the downloaded file.</p></li>
<li><p><strong>suffix</strong> – the suffix needed for download, like the mol for compound molfile and kcf for compound kcf file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_database_scraper.curate_molfile">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_database_scraper.</span></span><span class="sig-name descname"><span class="pre">curate_molfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_database_scraper.html#curate_molfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_database_scraper.curate_molfile" title="Permalink to this definition">¶</a></dt>
<dd><p>To curate the molfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_path</strong> – the molfile path.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_database_scraper.download">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_database_scraper.</span></span><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_database_scraper.html#download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_database_scraper.download" title="Permalink to this definition">¶</a></dt>
<dd><p>To download all the KEGG required files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>directory</strong> – the directory to store the data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mdh.KEGG_parser"></span><p>KEGG_parser.py provides functions to parse KEGG data (including compound, reaction, kcf, and rclass).</p>
<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.kegg_data_parser">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">kegg_data_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#kegg_data_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.kegg_data_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse KEGG data (reaction, rclass, compound) file to a dictionary.</p>
<p>eg:
ENTRY       R00259                      Reaction
NAME        acetyl-CoA:L-glutamate N-acetyltransferase
DEFINITION  Acetyl-CoA + L-Glutamate &lt;=&gt; CoA + N-Acetyl-L-glutamate
EQUATION    C00024 + C00025 &lt;=&gt; C00010 + C00624
RCLASS      RC00004  C00010_C00024</p>
<blockquote>
<div><p>RC00064  C00025_C00624</p>
</div></blockquote>
<p>ENZYME      2.3.1.1
PATHWAY     rn00220  Arginine biosynthesis</p>
<blockquote>
<div><p>rn01100  Metabolic pathways
rn01110  Biosynthesis of secondary metabolites
rn01210  2-Oxocarboxylic acid metabolism
rn01230  Biosynthesis of amino acids</p>
</div></blockquote>
<dl class="simple">
<dt>MODULE      M00028  Ornithine biosynthesis, glutamate =&gt; ornithine</dt><dd><p>M00845  Arginine biosynthesis, glutamate =&gt; acetylcitrulline =&gt; arginine</p>
</dd>
<dt>ORTHOLOGY   K00618  amino-acid N-acetyltransferase [EC:2.3.1.1]</dt><dd><p>K00619  amino-acid N-acetyltransferase [EC:2.3.1.1]
K00620  glutamate N-acetyltransferase / amino-acid N-acetyltransferase [EC:2.3.1.35 2.3.1.1]
K11067  N-acetylglutamate synthase [EC:2.3.1.1]
K14681  argininosuccinate lyase / amino-acid N-acetyltransferase [EC:4.3.2.1 2.3.1.1]
K14682  amino-acid N-acetyltransferase [EC:2.3.1.1]
K22476  N-acetylglutamate synthase [EC:2.3.1.1]
K22477  N-acetylglutamate synthase [EC:2.3.1.1]
K22478  bifunctional N-acetylglutamate synthase/kinase [EC:2.3.1.1 2.7.2.8]</p>
</dd>
</dl>
<p>DBLINKS     RHEA: 24295
///</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – the KEGG reaction description.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of parsed KEGG data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.parse_equation">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">parse_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation:</span> <span class="pre">str)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'dict'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'dict'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#parse_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.parse_equation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse the KEGG reaction equation.</p>
<p>eg:
C00029 + C00001 + 2 C00003 &lt;=&gt; C00167 + 2 C00004 + 2 C00080</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>equation</strong> – the equation string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the parsed KEGG reaction equation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.kegg_kcf_parser">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">kegg_kcf_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kcf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#kegg_kcf_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.kegg_kcf_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse KEGG kcf file to a dictionary.</p>
<p>eg:
ENTRY       C00013                      Compound
ATOM        9</p>
<blockquote>
<div><p>1   P1b P    22.2269  -20.0662
2   O2c O    23.5190  -20.0779
3   O1c O    21.0165  -20.0779
4   O1c O    22.2851  -21.4754
5   O1c O    22.2617  -18.4642
6   P1b P    24.8933  -20.0837
7   O1c O    24.9401  -21.4811
8   O1c O    26.1797  -20.0662
9   O1c O    24.9107  -18.4582</p>
</div></blockquote>
<dl class="simple">
<dt>BOND        8</dt><dd><p>1     1   2 1
2     1   3 1
3     1   4 1
4     1   5 2
5     2   6 1
6     6   7 1
7     6   8 1
8     6   9 2</p>
</dd>
</dl>
<p>///</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf</strong> – the kcf text.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of parsed kcf file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">reaction_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.__getnewargs__">
<span class="sig-name descname"><span class="pre">__getnewargs__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.__getnewargs__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a plain tuple.  Used by copy and pickle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.__new__">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.__new__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new instance of reaction_center(i, kat, label, match, difference)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a nicely formatted representation string</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.difference">
<span class="sig-name descname"><span class="pre">difference</span></span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.i">
<span class="sig-name descname"><span class="pre">i</span></span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.i" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.kat">
<span class="sig-name descname"><span class="pre">kat</span></span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.kat" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.label" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mdh.KEGG_parser.reaction_center.match">
<span class="sig-name descname"><span class="pre">match</span></span><a class="headerlink" href="#mdh.KEGG_parser.reaction_center.match" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">RpairParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rclass_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rclass_definitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to get one to one atom mappings between two compounds based on the rclass definition.</p>
<p>Several steps are involved in this process:
1) The rclass definition can have several pieces. Each piece describes a center atom (R) and its connected atoms.
The connected atoms can stay the same (M) or change (D) between the two compound structures.
2) First we need to find the center atoms based on the rlcass descriptions.
3) For each center atom, there are can multiple candidates. In other words, based on the RDM description,
a bunch of atoms in the compound can meet the descriptions. (One simple case are the symmetric compounds).
4) Therefore, we need to generate the all the combinations for the center atoms in a compound.
eg: if there are three atom centers, each center has several candidates:</p>
<blockquote>
<div><p>center 1: [0, 1, 2]; center 2: [5, 6]; center 3: [10, 11]
The combinations for the center atoms:
[0, 5, 10], [0, 5, 11], [0, 6, 10], [0, 6, 11], [1, 5, 10], [1, 5, 11], [1, 6, 10], [1, 6, 11], [2, 5, 10],
[2, 5, 11], [2, 6, 10], [2, 6, 11]</p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Next, we need to find the one to one atom mappings between the two compounds based on the mapped center atoms.</p></li>
</ol>
<p>6) To solve this issue, we first disassemble each compound into different components. This is due to the
difference atoms in the two compounds, i.e. broken bonds.
7) Then we need to find the mappings between each disassembled component, and concatenate the mappings of all
the components.
8) To find the one to one atom mappings, we use the BASS algorithm. We assume the mapped component have the same
structure since we have already removed the different parts. However, here we only map the backbone of the
structure (in other words, we simply all the bond type to 1) due to bond change (double bond to single bond or
triple bond to single bond)
9) To ensure the optimal mappings, we count the mapped atoms with changed local environment and choose the
mapping with minimal changed local colors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rclass_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rclass_definitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>RpairParser initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_name</strong> – the rclass name.</p></li>
<li><p><strong>rclass_definitions</strong> – a list of rclass definitions.</p></li>
<li><p><strong>one_compound</strong> – one compound involved in the pair.</p></li>
<li><p><strong>the_other_compound</strong> – the other compound involved in the pair.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.map_atom_by_colors">
<span class="sig-name descname"><span class="pre">map_atom_by_colors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.map_atom_by_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.map_atom_by_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>To roughly map the atoms between the two compounds by the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dict of mapped atom index between the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.map_whole_compound">
<span class="sig-name descname"><span class="pre">map_whole_compound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.map_whole_compound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.map_whole_compound" title="Permalink to this definition">¶</a></dt>
<dd><p>To map two compounds if the two compounds can be roughly mapped by the atom color.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the dict of mapped atom in the two compounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.generate_kat_neighbors">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_kat_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.generate_kat_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.generate_kat_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom neighbors represented by KEGG atom type for each atom in the compound.
This is used to find the center atom.
We used KEGG atom type since the descriptions of atoms in rclass definitions use KEGG atom type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>this_compound</strong> – the compound entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom with its neighbors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.find_target_atom">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_target_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.find_target_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.find_target_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the target atom from a list of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – a list of atoms to be searched.</p></li>
<li><p><strong>target</strong> – the target atom to be searched.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of atom number that match the target.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.create_reaction_centers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_reaction_centers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_difference</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">namedtuple</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.create_reaction_centers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.create_reaction_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>To create the center atom based on its connected atoms and its counterpart atom in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – the ith rclass definition.</p></li>
<li><p><strong>kat</strong> – KEGG atom type of the center atom.</p></li>
<li><p><strong>difference</strong> – the list of KEGG atom type of different connected atoms</p></li>
<li><p><strong>the_other_difference</strong> – the list of KEGG atom type of different connected atoms of the other compound.</p></li>
<li><p><strong>match</strong> – the list of KEGG atom type of the matched connected atoms.</p></li>
<li><p><strong>the_other_match</strong> – the list of KEGG atom type of the matched connected atoms of the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed reaction center.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.find_center_atoms">
<span class="sig-name descname"><span class="pre">find_center_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.find_center_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.find_center_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Example of rclass definition:
C8x-C8y:<a href="#id1"><span class="problematic" id="id2">*</span></a>-C1c:N5y+S2x-N5y+S2x
The RDM pattern is defined as KEGG atom type changes at the reaction center (R), the difference region (D),
and the matched region (M) for each reactant pair. It characterizes chemical structure transformation patterns
associated with enzymatic reactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of reaction centers and their corresponding candidate atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.get_center_list">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_center_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_atom_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.get_center_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.get_center_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate all the combinations of reaction centers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>center_atom_index</strong> – list of atom index list for each reaction centers. eg: three reaction centers:</p>
</dd>
</dl>
<p>[[0, 1, 2], [5, 6], [10, 11]].
:return: the list of combined reaction centers. eg: [[0, 5, 10], [0, 5, 11], [0, 6, 10], [0, 6, 11], [1, 5, 10],
[1, 5, 11], [1, 6, 10], [1, 6, 11], [2, 5, 10], [2, 5, 11], [2, 6, 10], [2, 6, 11]]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.remove_different_bonds">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remove_different_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_atom_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reaction_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.remove_different_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.remove_different_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>To remove the bonds connecting to different atoms. For each reaction center, multiple atoms can be the different
atoms. We need to get all the combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>center_atom_numbers</strong> – the list of atom numbers of center atom in the compound.</p></li>
<li><p><strong>reaction_centers</strong> – the list of reaction center descriptions of the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of bonds (represented by the atom numbers in the bond) that needs to be removed</p>
</dd>
</dl>
<p>based on the RDM descriptions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.generate_atom_mappings">
<span class="sig-name descname"><span class="pre">generate_atom_mappings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.generate_atom_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.generate_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the one to one atom mappings of the compound pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.detect_components">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detect_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">removed_bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_atom_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.detect_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.detect_components" title="Permalink to this definition">¶</a></dt>
<dd><p>To detect all the components in the compound after remove some bonds.
Basic idea is the breadth first search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>removed_bonds</strong> – the list of removed bonds (represented by the atom numbers in the bond) in the compound.</p></li>
<li><p><strong>center_atom_numbers</strong> – the list of atom numbers of the center atoms in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of components of the compound represented by a list of atom numbers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.pair_components">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pair_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.pair_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.pair_components" title="Permalink to this definition">¶</a></dt>
<dd><p>The two compounds are divided into separate components due to difference atoms. We need to pair each component
in one compound to its counterpart component in the other compound.
Here roughly pair the components based on the number of atoms in the component. Therefore, every component in
one compound can be paired with several components in the other compound.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_components</strong> – the components in one compound.</p></li>
<li><p><strong>right_components</strong> – the components in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of paired components.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.construct_component">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">construct_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">this_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removed_bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.construct_component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.construct_component" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct a <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity for the component based on the atom index and removed
bonds, facilitating the following atom mappings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>this_compound</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>atom_numbers</strong> – the list of atom numbers for atoms in the component.</p></li>
<li><p><strong>removed_bonds</strong> – the list of removed bonds (represented by the atom numbers in the bond) in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed component.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.preliminary_atom_mappings_check">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">preliminary_atom_mappings_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.preliminary_atom_mappings_check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.preliminary_atom_mappings_check" title="Permalink to this definition">¶</a></dt>
<dd><p>To roughly evaluate if the atoms between the two components can be mapped.
We compare if the every atom color in the left component has its counterpart in the right component.
Here, we only consider the backbone of the structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_component</strong> – the component in one compound.</p></li>
<li><p><strong>right_component</strong> – the component in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the atoms in the two components can be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.map_components">
<span class="sig-name descname"><span class="pre">map_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_removed_bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_removed_bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.map_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.map_components" title="Permalink to this definition">¶</a></dt>
<dd><p>To find optimal map for every component in the compound pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_removed_bonds</strong> – the list of removed bonds in one compound.</p></li>
<li><p><strong>right_removed_bonds</strong> – the list of removed bonds in the other compound.</p></li>
<li><p><strong>left_centers</strong> – the list of atom numbers of the center atoms in the one compound.</p></li>
<li><p><strong>right_centers</strong> – the list of atom numbers of the center atoms in the other compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings for the compound pair based on the removed bonds and center atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.combine_atom_mappings">
<span class="sig-name descname"><span class="pre">combine_atom_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.combine_atom_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.combine_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To combine the atom mappings of all the components.
We just mentioned in the pair_components function that every component can have several mappings.
Here, we choose the optimal mapping with the least count of changed atom local identifier. And make sure
that each atom can only to mapped once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_mappings</strong> – the list of atom mappings for all the components.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings for the compound pair.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.validate_component_atom_mappings">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_component_atom_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_centers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.validate_component_atom_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.validate_component_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if mapped the atoms can correspond to the mapped reaction center atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left_centers</strong> – the list of center atom index in the left compound.</p></li>
<li><p><strong>right_centers</strong> – the list of center atom index in the right compound.</p></li>
<li><p><strong>component_atom_mappings</strong> – the one to one atom mappings of one component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the mappings are valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.KEGG_parser.RpairParser.count_changed_atom_identifiers">
<span class="sig-name descname"><span class="pre">count_changed_atom_identifiers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_to_one_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#RpairParser.count_changed_atom_identifiers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.RpairParser.count_changed_atom_identifiers" title="Permalink to this definition">¶</a></dt>
<dd><p>To count the mapped atoms with changed local atom identifier. The different atoms (D in RCLASS definitions)
can cause change of local environment, which can change the atom identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>one_to_one_mappings</strong> – the dictionary of atom mappings between the two compounds.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the total number of mapped atoms with different local identifier.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.create_compound_kcf">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">create_compound_kcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kcf_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#create_compound_kcf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.create_compound_kcf" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct compound entity based on the KEGG kcf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf_file</strong> – the filename contains kcf text.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed compound entity.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.create_reactions">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">create_reactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#create_reactions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.create_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>To create KEGG <cite>~mdh.reaction.Reaction</cite> entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_directory</strong> – the directory that stores all the reaction files.</p></li>
<li><p><strong>compounds</strong> – a dictionary of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>atom_mappings</strong> – the compound pair name and its atom mappings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed <cite>~mdh.reaction.Reaction</cite> entities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.compound_pair_mappings">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">compound_pair_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rclass_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rclass_definitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#compound_pair_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.compound_pair_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the atom mappings between two compounds based on the rclass definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_name</strong> – the name of the rclass.</p></li>
<li><p><strong>rclass_definitions</strong> – the list of rclass definitions.</p></li>
<li><p><strong>one_compound</strong> – one compound entity involved in the compound pair.</p></li>
<li><p><strong>the_other_compound</strong> – the other compound entity involved in the compound pair.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the compound pair name and its atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.KEGG_parser.create_atom_mappings">
<span class="sig-prename descclassname"><span class="pre">mdh.KEGG_parser.</span></span><span class="sig-name descname"><span class="pre">create_atom_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rclass_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/KEGG_parser.html#create_atom_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.KEGG_parser.create_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the atom mappings between compounds based on RCLASS definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rclass_directory</strong> – the directory that stores the rclass files.</p></li>
<li><p><strong>compounds</strong> – a dictionary of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings of compound pairs.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mdh.MetaCyc_parser"></span><p>MetaCyc_parser.py is used to parse MetaCyc text data.
Note: All MetaCyc reactions atom_mappings are stored in a single text file.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mdh.MetaCyc_parser.reaction_side_parser">
<span class="sig-prename descclassname"><span class="pre">mdh.MetaCyc_parser.</span></span><span class="sig-name descname"><span class="pre">reaction_side_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/MetaCyc_parser.html#reaction_side_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.MetaCyc_parser.reaction_side_parser" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This is to parse FROM_SIDE or TO_SIDE in the reaction.</p>
</div></blockquote>
<p>eg: FROM-SIDE - (CPD-9147 0 8) (OXYGEN-MOLECULE 9 10)</p>
<p>Information includes compound name and the start and end atom index in this compound used for atom mappings.
The order of the atoms are the orders in the compound molfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reaction_side</strong> – the text description of reaction side.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of compounds and the corresponding start and end atom index in the atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.MetaCyc_parser.generate_one_to_one_mappings">
<span class="sig-prename descclassname"><span class="pre">mdh.MetaCyc_parser.</span></span><span class="sig-name descname"><span class="pre">generate_one_to_one_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/MetaCyc_parser.html#generate_one_to_one_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.MetaCyc_parser.generate_one_to_one_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To generate the one to one atom mappings between two the sides of metabolic reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_side</strong> – the dictionary of compounds with their corresponding start and end atom index in the from_side.</p></li>
<li><p><strong>to_side</strong> – the dictionary of compounds with their corresponding start and end atom index in the to_side.</p></li>
<li><p><strong>indices</strong> – the list of mapped atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of mapped atoms between the two sides.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.MetaCyc_parser.atom_mappings_parser">
<span class="sig-prename descclassname"><span class="pre">mdh.MetaCyc_parser.</span></span><span class="sig-name descname"><span class="pre">atom_mappings_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_mapping_text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/MetaCyc_parser.html#atom_mappings_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.MetaCyc_parser.atom_mappings_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is to parse the MetaCyc reaction with atom mappings.</p>
<p>eg:
REACTION - RXN-11981
NTH-ATOM-MAPPING - 1
MAPPING-TYPE - NO-HYDROGEN-ENCODING
FROM-SIDE - (CPD-12950 0 23) (WATER 24 24)
TO-SIDE - (CPD-12949 0 24)
INDICES - 0 1 2 3 5 4 7 6 9 10 11 13 12 14 15 16 17 8 18 19 21 20 22 24 23</p>
<p>note: the INDICES are atom mappings between two sides of the reaction.
TO-SIDE[i] is mapped to FROM-SIDE[idx] for i, idx in enumerate(INDICES).
Pay attention to the direction!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_mapping_text</strong> – the text descriptions of reactions with atom mappings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of reactions with atom mappings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.MetaCyc_parser.reaction_parser">
<span class="sig-prename descclassname"><span class="pre">mdh.MetaCyc_parser.</span></span><span class="sig-name descname"><span class="pre">reaction_parser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/MetaCyc_parser.html#reaction_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.MetaCyc_parser.reaction_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to parse MetaCyc reaction.</p>
<p>eg:
UNIQUE-ID - RXN-13583
TYPES - Redox-Half-Reactions
ATOM-MAPPINGS - (:NO-HYDROGEN-ENCODING (1 0 2) (((WATER 0 0) (HYDROXYLAMINE 1 2)) ((NITRITE 0 2))))
CREDITS - SRI
CREDITS - caspi
IN-PATHWAY - HAONITRO-RXN
LEFT - NITRITE
^COMPARTMENT - CCO-IN
LEFT - PROTON
^COEFFICIENT - 5
^COMPARTMENT - CCO-IN
LEFT - E-
^COEFFICIENT - 4
ORPHAN? - :NO
PHYSIOLOGICALLY-RELEVANT? - T
REACTION-BALANCE-STATUS - :BALANCED
REACTION-DIRECTION - LEFT-TO-RIGHT
RIGHT - HYDROXYLAMINE
^COMPARTMENT - CCO-IN
RIGHT - WATER
^COMPARTMENT - CCO-IN
STD-REDUCTION-POTENTIAL - 0.1
//</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reaction_text</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>.) – the text descriptions of MetaCyc reactions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dict of parsed MetaCyc reactions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.MetaCyc_parser.create_reactions">
<span class="sig-prename descclassname"><span class="pre">mdh.MetaCyc_parser.</span></span><span class="sig-name descname"><span class="pre">create_reactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mapping_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/MetaCyc_parser.html#create_reactions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.MetaCyc_parser.create_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>To create MetaCyc reaction entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_file</strong> – the filename of the reaction file.</p></li>
<li><p><strong>atom_mapping_file</strong> – the filename of the atom mapping file.</p></li>
<li><p><strong>compounds</strong> – a dictionary of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed <cite>~mdh.reaction.Reaction</cite> entities.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mdh.aromatics"></span><section id="mdh-aromatics">
<h2>MDH.aromatics<a class="headerlink" href="#mdh-aromatics" title="Permalink to this heading">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#mdh.aromatics.AromaticManager" title="mdh.aromatics.AromaticManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">AromaticManager</span></code></a> class entity.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.aromatics.</span></span><span class="sig-name descname"><span class="pre">AromaticManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromatic_substructures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Two major functions are implemented in AromaticManager.
1) Extract aromatic substructures based on labelled aromatic atoms (mainly C and N) Or indigo detected aromatic bonds.</p>
<blockquote>
<div><p>The first case only applies to KEGG compounds, and the second case applies to compound from any databases.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Detect the aromatic substructures in any given compound, and update the bond type of the detected aromatic bonds.</p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromatic_substructures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>AromaticManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>aromatic_substructures</strong> – a list of aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>To encode the aromatic substructures in the aromatic manager. (Get error when try to jsonpickle the
AromaticManager: the cythonized entities cannot be pickled.)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.decode">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aromatic_structures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.decode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the AromaticManager based on the components of aromatic substructures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>aromatic_structures</strong> – the list of components of aromatic substructures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the constructed AromaticManager.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.add_aromatic_substructures">
<span class="sig-name descname"><span class="pre">add_aromatic_substructures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substructures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.add_aromatic_substructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.add_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Add newly detected aromatic structures to the manager. Make sure no duplicates in the aromatic substructures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>substructures</strong> – a list of aromatic substructures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.kegg_aromatize">
<span class="sig-name descname"><span class="pre">kegg_aromatize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kcf_cpd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.kegg_aromatize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.kegg_aromatize" title="Permalink to this definition">¶</a></dt>
<dd><p>To extract aromatic substructures based on KEGG atom type in KEGG compound parsed from KCF file, and add the
newly detected aromatic substructures to the AromaticManger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kcf_cpd</strong> – the KEGG compound entity derived from KCF file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.indigo_aromatize">
<span class="sig-name descname"><span class="pre">indigo_aromatize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.indigo_aromatize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.indigo_aromatize" title="Permalink to this definition">¶</a></dt>
<dd><p>To extract aromatic substructures via Indigo, and add the newly detected aromatic substructures to the
AromaticManger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the filename of the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.indigo_aromatic_bonds">
<span class="sig-name descname"><span class="pre">indigo_aromatic_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.indigo_aromatic_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.indigo_aromatic_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>To detect the aromatic bonds in the compound via Indigo method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molfile</strong> – the filename of the molfile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the set of aromatic bonds represented by first_atom_number and second_atom_number of the bond.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.fuse_cycles">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fuse_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.fuse_cycles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.fuse_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>To fuse the cycles with shared atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cycles</strong> – the list of individual cycles represented by atom numbers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of fused cycles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.detect_aromatic_substructures_timeout">
<span class="sig-name descname"><span class="pre">detect_aromatic_substructures_timeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.detect_aromatic_substructures_timeout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.detect_aromatic_substructures_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>To detect the aromatic substructures in the compound and stop the search on timeout.
:param cpd: the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.
:return: None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.detect_aromatic_substructures">
<span class="sig-name descname"><span class="pre">detect_aromatic_substructures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.detect_aromatic_substructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.detect_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect all the aromatic substructures in the cpd, and update the bond type of aromatic bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cpd</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.construct_aromatic_entity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">construct_aromatic_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">aromatic_cycles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.construct_aromatic_entity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.construct_aromatic_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>To construct the aromatic substructure entity based on the aromatic atoms.
Here, we also include outside atoms that are connected to aromatic rings with double bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpd</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p></li>
<li><p><strong>aromatic_cycles</strong> – the list of aromatic cycles represented by atom numbers in the compound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of constructed aromatic substructures.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.aromatics.AromaticManager.extract_aromatic_substructures">
<span class="sig-name descname"><span class="pre">extract_aromatic_substructures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/aromatics.html#AromaticManager.extract_aromatic_substructures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.aromatics.AromaticManager.extract_aromatic_substructures" title="Permalink to this definition">¶</a></dt>
<dd><p>To detect the aromatic substructures in a compound based on the aromatic atoms. This is just for KEGG kcf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cpd</strong> – the <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of aromatic cycles represented by atom numbers.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-mdh.harmonization"></span><section id="mdh-harmonization">
<h2>mdh.harmonization<a class="headerlink" href="#mdh-harmonization" title="Permalink to this heading">¶</a></h2>
<p>This module provides the <a class="reference internal" href="#mdh.harmonization.HarmonizedEdge" title="mdh.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> class,
the <a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">mdh.harmonization.HarmonizedCompoundEdge</span></code></a> class,
and the <a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge" title="mdh.harmonization.HarmonizedReactionEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedReactionEdge</span></code></a> class .</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">HarmonizedEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedEdge to represent compound or reaction pairs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedEdge.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedEdge.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_side</strong> – one side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>the_other_side</strong> – the other side of the edge. This can be compound or reaction.</p></li>
<li><p><strong>relationship</strong> – equivalent, generic-specific, or loose.</p></li>
<li><p><strong>edge_type</strong> – for compound edge, this represents resonance, linear-circular, r group, same structure;</p></li>
</ul>
</dd>
</dl>
<p>for reaction edge, this represents 3 level match or 4 level match.
:param mappings: for compound edge, the mappings refer to mapped atoms between compounds; for reaction edge,
the mappings refer to mapped compounds between reaction.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedEdge.reversed_relationship">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reversed_relationship</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#mdh.harmonization.HarmonizedEdge.reversed_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the relationship between the other side and one side.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the reversed relationship.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedEdge.pair_relationship">
<span class="sig-name descname"><span class="pre">pair_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedEdge.pair_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedEdge.pair_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>When we map compounds in the reaction, we can access the compound edge from either side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – the name of the searched one side.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationship of the searched pair.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedCompoundEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">HarmonizedCompoundEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedCompoundEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedCompoundEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedCompoundEdge to represent compound pairs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedCompoundEdge.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compound</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><span class="pre">Compound</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedCompoundEdge.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedCompoundEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedCompoundEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compound</strong> – one <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>the_other_compound</strong> – the other <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entity in the compound pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two compounds.</p></li>
<li><p><strong>edge_type</strong> – the edge type can be resonance, linear-circular, r group, or same structure.</p></li>
<li><p><strong>atom_mappings</strong> – the atom mappings between the two compounds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedCompoundEdge.reversed_mappings">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reversed_mappings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#mdh.harmonization.HarmonizedCompoundEdge.reversed_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the atom mappings from compound on the other side to compound on the one side.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>atom mappings between the other side compound to one side compound.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedCompoundEdge.pair_atom_mappings">
<span class="sig-name descname"><span class="pre">pair_atom_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedCompoundEdge.pair_atom_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedCompoundEdge.pair_atom_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the atom mappings of the harmonized compound edge, where one side equals to the parameter name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> – the compound name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the atom mappings.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedReactionEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">HarmonizedReactionEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedReactionEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedReactionEdge" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizedReactionEdge to represent reaction pairs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizedReactionEdge.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">relationship</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizedReactionEdge.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizedReactionEdge.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizedReactionEdge initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_reaction</strong> – one <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>the_other_reaction</strong> – the other <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> entity in the reaction pair.</p></li>
<li><p><strong>relationship</strong> – the relationship (equivalent, generic-specific, or loose) between the two reactions.</p></li>
<li><p><strong>edge_type</strong> – the reactions can be 3-level EC or 4-level EC paired.</p></li>
<li><p><strong>compound_mappings</strong> – the dictionary of paired compounds in the reaction pair.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">HarmonizationManager</span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The HarmonizationManger takes charge of adding, removing or searching harmonized edge.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>HarmonizationManager initializer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.save_manager">
<span class="sig-name descname"><span class="pre">save_manager</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.save_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.save_manager" title="Permalink to this definition">¶</a></dt>
<dd><p>To save all the names of harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of harmonized edges.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.create_key">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.create_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.create_key" title="Permalink to this definition">¶</a></dt>
<dd><p>To create the edge key. Each edge is represented by a unique key in the harmonized_edges dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the key of the edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.add_edge">
<span class="sig-name descname"><span class="pre">add_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><span class="pre">HarmonizedCompoundEdge</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge" title="mdh.harmonization.HarmonizedReactionEdge"><span class="pre">HarmonizedReactionEdge</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.add_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>To add this edge to the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#mdh.harmonization.HarmonizedEdge" title="mdh.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge does not exist and is added successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.remove_edge">
<span class="sig-name descname"><span class="pre">remove_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><span class="pre">HarmonizedCompoundEdge</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge" title="mdh.harmonization.HarmonizedReactionEdge"><span class="pre">HarmonizedReactionEdge</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.remove_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.remove_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>To remove this edge from the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#mdh.harmonization.HarmonizedEdge" title="mdh.harmonization.HarmonizedEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge exists and is removed successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.HarmonizationManager.search">
<span class="sig-name descname"><span class="pre">search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><span class="pre">HarmonizedCompoundEdge</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge" title="mdh.harmonization.HarmonizedReactionEdge"><span class="pre">HarmonizedReactionEdge</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#HarmonizationManager.search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.HarmonizationManager.search" title="Permalink to this definition">¶</a></dt>
<dd><p>To search the edge based on the names of the two sides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>edge if the edge exists or None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">CompoundHarmonizationManager</span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The CompoundHarmonizationManager takes charge of adding, removing or searching
<a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>CompoundHarmonizationManager initializer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.find_compound">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_compound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.find_compound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.find_compound" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_dict</strong> – </p></li>
<li><p><strong>compound_name</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.create_manager">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.create_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.create_manager" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound_dict</strong> – </p></li>
<li><p><strong>compound_pairs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.add_edge">
<span class="sig-name descname"><span class="pre">add_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><span class="pre">HarmonizedCompoundEdge</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.add_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>To add a newly detected edge to the manager, and update the occurrences of compound in the harmonized edges.
This is for calculating the jaccard index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge does not exist and is added successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.remove_edge">
<span class="sig-name descname"><span class="pre">remove_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><span class="pre">HarmonizedCompoundEdge</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.remove_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.remove_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>To remove the edge from the manager, and update the occurrences of compound in the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> – the <a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge" title="mdh.harmonization.HarmonizedCompoundEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a> entity.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool whether the edge exists and is removed successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.has_visited">
<span class="sig-name descname"><span class="pre">has_visited</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.has_visited"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.has_visited" title="Permalink to this definition">¶</a></dt>
<dd><p>To check if the compound pair has been visited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool if the pair has been visited.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.add_invalid">
<span class="sig-name descname"><span class="pre">add_invalid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.add_invalid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.add_invalid" title="Permalink to this definition">¶</a></dt>
<dd><p>To add the name of invalid compound pair to the visited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_1</strong> – the name of one side of the edge.</p></li>
<li><p><strong>name_2</strong> – the name of the other side of the edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.CompoundHarmonizationManager.get_edge_list">
<span class="sig-name descname"><span class="pre">get_edge_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#CompoundHarmonizationManager.get_edge_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.CompoundHarmonizationManager.get_edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the names of all the harmonized edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the list of names of harmonized edges.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">ReactionHarmonizationManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_harmonization_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><span class="pre">CompoundHarmonizationManager</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager" title="Permalink to this definition">¶</a></dt>
<dd><p>The ReactionHarmonizationManager takes charge of adding, removing or searching
<a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge" title="mdh.harmonization.HarmonizedReactionEdge"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonizedReactionEdge</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_harmonization_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><span class="pre">CompoundHarmonizationManager</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>ReactionHarmonizationManager initializer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compound_harmonization_manager</strong> – the <a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> entity for</p>
</dd>
</dl>
<p>compound pairs management.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.compare_ecs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compare_ecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_ecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_ecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.compare_ecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.compare_ecs" title="Permalink to this definition">¶</a></dt>
<dd><p>To compare two lists of EC numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_ecs</strong> – the dict of EC numbers of one reaction.</p></li>
<li><p><strong>the_other_ecs</strong> – the dict of EC numbers of the other reaction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the level of EC number that they can be matched.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.determine_relationship">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">determine_relationship</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relationships</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.determine_relationship"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.determine_relationship" title="Permalink to this definition">¶</a></dt>
<dd><p>To determine the relationship of the reaction pair based on the relationship of paired compounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>relationships</strong> – the list of relationship of compound pairs in the two reactions.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the relationships between the two reactions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.harmonize_reaction">
<span class="sig-name descname"><span class="pre">harmonize_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_reaction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><span class="pre">Reaction</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.harmonize_reaction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.harmonize_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>To test if two reactions can be harmonized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_reaction</strong> – one <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> that is involved in the reaction pair.</p></li>
<li><p><strong>the_other_reaction</strong> – the other <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> that is involved in the reaction pair.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.compound_mappings">
<span class="sig-name descname"><span class="pre">compound_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.compound_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.compound_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the mapped compounds in the two compound lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>the_other_compounds</strong> – the other list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dictionary of paired compounds with their relationship. The relationship will be used to determine</p>
</dd>
</dl>
<p>the relationship of reaction pair.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.unmapped_compounds">
<span class="sig-name descname"><span class="pre">unmapped_compounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.unmapped_compounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.unmapped_compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>To get the compounds that cannot be mapped. This can lead to new compound pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>the_other_compounds</strong> – the other list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>mappings</strong> – the mapped compounds between the two compound lists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>two lists of compounds that cannot be mapped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.match_unmapped_compounds">
<span class="sig-name descname"><span class="pre">match_unmapped_compounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_side_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_side_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.match_unmapped_compounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.match_unmapped_compounds" title="Permalink to this definition">¶</a></dt>
<dd><p>To match the left compounds and add the valid compound pairs to the
<a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a>.
We also add the invalid compound pairs to the <a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> to avoid
redundant match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_side_left</strong> – one list of left <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>the_other_side_left</strong> – the other list of left <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.jaccard">
<span class="sig-name descname"><span class="pre">jaccard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_other_compounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.jaccard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.jaccard" title="Permalink to this definition">¶</a></dt>
<dd><p>To calculate the jaccard index between the two list of compounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>one_compounds</strong> – one list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>the_other_compounds</strong> – the other list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> entities.</p></li>
<li><p><strong>mappings</strong> – the dictionary of mapped compounds between the two compound lists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the jaccard index of the two compound lists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mdh.harmonization.ReactionHarmonizationManager.one_to_one_compound_mappings">
<span class="sig-name descname"><span class="pre">one_to_one_compound_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#ReactionHarmonizationManager.one_to_one_compound_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.ReactionHarmonizationManager.one_to_one_compound_mappings" title="Permalink to this definition">¶</a></dt>
<dd><p>To find the one to one compound mappings between the two reactions.
This step is to avoid very extreme cases that a compound in one reaction can be mapped to two or more compounds
in the other reaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mappings</strong> – the dictionary of compound mappings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the tuple of relationship of compound pairs and dictionary of one to one compound mappings.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.harmonization.harmonize_compound_list">
<span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">harmonize_compound_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compound_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><span class="pre">CompoundHarmonizationManager</span></a></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#harmonize_compound_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.harmonize_compound_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To harmonize compounds across different databases based on the compound coloring identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compound_list</strong> – the list of <a class="reference internal" href="#mdh.compound.Compound" title="mdh.compound.Compound"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compound</span></code></a> dictionary from different sources.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the <a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> entity with harmonized compound edges.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mdh.harmonization.harmonize_reaction_list">
<span class="sig-prename descclassname"><span class="pre">mdh.harmonization.</span></span><span class="sig-name descname"><span class="pre">harmonize_reaction_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reaction_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compound_harmonization_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><span class="pre">CompoundHarmonizationManager</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mdh.harmonization.ReactionHarmonizationManager" title="mdh.harmonization.ReactionHarmonizationManager"><span class="pre">ReactionHarmonizationManager</span></a></span></span><a class="reference internal" href="_modules/mdh/harmonization.html#harmonize_reaction_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.harmonization.harmonize_reaction_list" title="Permalink to this definition">¶</a></dt>
<dd><p>To harmonize reactions across different sources based on the harmonized compounds. At the same time, this also
harmonizes compound pairs with resonance, linear-circular, r group types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reaction_list</strong> – a list of <a class="reference internal" href="#mdh.reaction.Reaction" title="mdh.reaction.Reaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reaction</span></code></a> list from different sources.</p></li>
<li><p><strong>compound_harmonization_manager</strong> – a <a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager" title="mdh.harmonization.CompoundHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a> containing</p></li>
</ul>
</dd>
</dl>
<p>harmonized compound pairs with the same structure.
:return: <a class="reference internal" href="#mdh.harmonization.ReactionHarmonizationManager" title="mdh.harmonization.ReactionHarmonizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReactionHarmonizationManager</span></code></a></p>
</dd></dl>

<span class="target" id="module-mdh.cli"></span><p>MDH command-line interface</p>
<dl>
<dt>Usage:</dt><dd><p>mdh -h | –help
mdh –version
mdh download &lt;database_names&gt; &lt;working_directory&gt;
mdh standardize &lt;database_names&gt; &lt;working_directory&gt;
mdh aromatize &lt;database_names&gt; &lt;working_directory&gt; &lt;save_file&gt; [–aromatic_manager=&lt;aromatic_manager_file&gt;]
mdh initialize_compound &lt;database_names&gt; &lt;working_directory&gt; &lt;aromatic_manager_file&gt; [–parse_kegg_atom]
mdh initialize_reaction &lt;database_names&gt; &lt;working_directory&gt;
mdh harmonize &lt;database_names&gt; &lt;working_directory&gt;
mdh test4 &lt;database_names&gt; &lt;working_directory&gt;
mdh test7 &lt;k&gt;
mdh test1</p>
</dd>
<dt>Options:</dt><dd><dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Show this screen.</p>
</dd>
<dt><kbd><span class="option">--version</span></kbd></dt>
<dd><p>Show version.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="mdh.cli.cli">
<span class="sig-prename descclassname"><span class="pre">mdh.cli.</span></span><span class="sig-name descname"><span class="pre">cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mdh/cli.html#cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdh.cli.cli" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">mdh</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">The MDH Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The MDH API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mdh-compound">mdh.compound</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.compound.Atom"><code class="docutils literal notranslate"><span class="pre">Atom</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.compound.Bond"><code class="docutils literal notranslate"><span class="pre">Bond</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.compound.Compound"><code class="docutils literal notranslate"><span class="pre">Compound</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh-reaction">MDH.reaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.reaction.Reaction"><code class="docutils literal notranslate"><span class="pre">Reaction</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_database_scraper.entry_list"><code class="docutils literal notranslate"><span class="pre">entry_list()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_database_scraper.update_entity"><code class="docutils literal notranslate"><span class="pre">update_entity()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_database_scraper.curate_molfile"><code class="docutils literal notranslate"><span class="pre">curate_molfile()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_database_scraper.download"><code class="docutils literal notranslate"><span class="pre">download()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.kegg_data_parser"><code class="docutils literal notranslate"><span class="pre">kegg_data_parser()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.parse_equation"><code class="docutils literal notranslate"><span class="pre">parse_equation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.kegg_kcf_parser"><code class="docutils literal notranslate"><span class="pre">kegg_kcf_parser()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.reaction_center"><code class="docutils literal notranslate"><span class="pre">reaction_center</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.RpairParser"><code class="docutils literal notranslate"><span class="pre">RpairParser</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.create_compound_kcf"><code class="docutils literal notranslate"><span class="pre">create_compound_kcf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.create_reactions"><code class="docutils literal notranslate"><span class="pre">create_reactions()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.compound_pair_mappings"><code class="docutils literal notranslate"><span class="pre">compound_pair_mappings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.KEGG_parser.create_atom_mappings"><code class="docutils literal notranslate"><span class="pre">create_atom_mappings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.MetaCyc_parser.reaction_side_parser"><code class="docutils literal notranslate"><span class="pre">reaction_side_parser()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.MetaCyc_parser.generate_one_to_one_mappings"><code class="docutils literal notranslate"><span class="pre">generate_one_to_one_mappings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.MetaCyc_parser.atom_mappings_parser"><code class="docutils literal notranslate"><span class="pre">atom_mappings_parser()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.MetaCyc_parser.reaction_parser"><code class="docutils literal notranslate"><span class="pre">reaction_parser()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.MetaCyc_parser.create_reactions"><code class="docutils literal notranslate"><span class="pre">create_reactions()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh-aromatics">MDH.aromatics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.aromatics.AromaticManager"><code class="docutils literal notranslate"><span class="pre">AromaticManager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh-harmonization">mdh.harmonization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.HarmonizedEdge"><code class="docutils literal notranslate"><span class="pre">HarmonizedEdge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.HarmonizedCompoundEdge"><code class="docutils literal notranslate"><span class="pre">HarmonizedCompoundEdge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.HarmonizedReactionEdge"><code class="docutils literal notranslate"><span class="pre">HarmonizedReactionEdge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.HarmonizationManager"><code class="docutils literal notranslate"><span class="pre">HarmonizationManager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.CompoundHarmonizationManager"><code class="docutils literal notranslate"><span class="pre">CompoundHarmonizationManager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.ReactionHarmonizationManager"><code class="docutils literal notranslate"><span class="pre">ReactionHarmonizationManager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.harmonize_compound_list"><code class="docutils literal notranslate"><span class="pre">harmonize_compound_list()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.harmonization.harmonize_reaction_list"><code class="docutils literal notranslate"><span class="pre">harmonize_reaction_list()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mdh.cli.cli"><code class="docutils literal notranslate"><span class="pre">cli()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tutorial.html" title="previous chapter">The MDH Tutorial</a></li>
      <li>Next: <a href="license.html" title="next chapter">License</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Huan Jin, Hunter N.B. Moseley.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>